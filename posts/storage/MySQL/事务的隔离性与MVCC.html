<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.49" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://www.chanmufeng.com/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html"><meta property="og:site_name" content="è‰æ²é£"><meta property="og:title" content="äº‹åŠ¡çš„éš”ç¦»æ€§ä¸MVCC"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-08-03T06:14:46.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="MySQL"><meta property="article:tag" content="äº‹åŠ¡"><meta property="article:tag" content="éš”ç¦»æ€§"><meta property="article:tag" content="MVCC"><meta property="article:published_time" content="2022-04-20T00:00:00.000Z"><meta property="article:modified_time" content="2022-08-03T06:14:46.000Z"><script>
                var _hmt = _hmt || [];
                (function() {
                  var hm = document.createElement("script");
                  hm.src = "https://hm.baidu.com/hm.js?dfa689801ccd10bd283b50ea146430f3";
                  var s = document.getElementsByTagName("script")[0]; 
                  s.parentNode.insertBefore(hm, s);
                })();
            </script><title>äº‹åŠ¡çš„éš”ç¦»æ€§ä¸MVCC | è‰æ²é£</title><meta name="description" content="Chanmufeng's Personal Website">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.ef97199c.css">
    <link rel="modulepreload" href="/assets/app.ec803d45.js"><link rel="modulepreload" href="/assets/äº‹åŠ¡çš„éš”ç¦»æ€§ä¸MVCC.html.68831001.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/äº‹åŠ¡çš„éš”ç¦»æ€§ä¸MVCC.html.a4ad4ac5.js"><link rel="prefetch" href="/assets/index.html.f40aab20.js"><link rel="prefetch" href="/assets/home.html.4311fb4f.js"><link rel="prefetch" href="/assets/update.html.72163859.js"><link rel="prefetch" href="/assets/index.html.bc679553.js"><link rel="prefetch" href="/assets/index.html.42b16337.js"><link rel="prefetch" href="/assets/disable.html.a298796c.js"><link rel="prefetch" href="/assets/encrypt.html.04234872.js"><link rel="prefetch" href="/assets/markdown.html.c40cf8e1.js"><link rel="prefetch" href="/assets/JVMåˆ°åº•è¯¥å­¦ä¹ äº›ä»€ä¹ˆ.html.37a1cd31.js"><link rel="prefetch" href="/assets/index.html.bdb8aaf2.js"><link rel="prefetch" href="/assets/æˆ‘æ˜¯ä¸€ä¸ªåƒåœ¾.html.396cd500.js"><link rel="prefetch" href="/assets/CPUæµæ°´çº¿ä¸æŒ‡ä»¤é‡æ’åº.html.da7853a1.js"><link rel="prefetch" href="/assets/index.html.9cfc822d.js"><link rel="prefetch" href="/assets/ç”¨ã€Œé—ªç”µä¾ ã€è§£é‡Šä¸€ä¸‹è¿›ç¨‹å’Œçº¿ç¨‹.html.9c93b056.js"><link rel="prefetch" href="/assets/ç¼“å­˜ä¸€è‡´æ€§ä¸å†…å­˜å±éšœ.html.51552874.js"><link rel="prefetch" href="/assets/index.html.67e2e3d9.js"><link rel="prefetch" href="/assets/network-programming.html.287d3b4f.js"><link rel="prefetch" href="/assets/index.html.0a6236b7.js"><link rel="prefetch" href="/assets/ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦.html.804cd066.js"><link rel="prefetch" href="/assets/index.html.1f5ae493.js"><link rel="prefetch" href="/assets/åŠ¨æ€ä»£ç†æ¨¡å¼.html.90a17679.js"><link rel="prefetch" href="/assets/å•ä¾‹æ¨¡å¼.html.c3742e12.js"><link rel="prefetch" href="/assets/å·¥å‚æ¨¡å¼.html.f8c7f9d6.js"><link rel="prefetch" href="/assets/é™æ€ä»£ç†æ¨¡å¼.html.7bbcf6f5.js"><link rel="prefetch" href="/assets/ä¾èµ–å€’ç½®åŸåˆ™.html.56bde280.js"><link rel="prefetch" href="/assets/å¼€é—­åŸåˆ™.html.d45ce1b8.js"><link rel="prefetch" href="/assets/Googleæœç´¢ä¸ºä»€ä¹ˆä¸èƒ½æ— é™åˆ†é¡µï¼Ÿ.html.5b88d232.js"><link rel="prefetch" href="/assets/index.html.abd3d401.js"><link rel="prefetch" href="/assets/m1èŠ¯ç‰‡ç”µè„‘å®‰è£…cerebro.html.0120f768.js"><link rel="prefetch" href="/assets/MySQLä¸Redisçš„æ•°æ®ä¸€è‡´æ€§.html.5ba6736f.js"><link rel="prefetch" href="/assets/MySQLä¼˜åŒ–çš„5ä¸ªç»´åº¦.html.4362df81.js"><link rel="prefetch" href="/assets/MySQLç´¢å¼•çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿.html.d51dd9cb.js"><link rel="prefetch" href="/assets/MySQLé”å¼€ç¯‡.html.36ef8a4c.js"><link rel="prefetch" href="/assets/index.html.c8eb6a41.js"><link rel="prefetch" href="/assets/ä¸€æ¡SELECTè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.2ace0b89.js"><link rel="prefetch" href="/assets/ä¸€æ¡Updateè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.8736dea8.js"><link rel="prefetch" href="/assets/ä¸ºä»€ä¹ˆMySQLçš„ä¸»é”®æŸ¥è¯¢è¿™ä¹ˆå¿«.html.69305ec3.js"><link rel="prefetch" href="/assets/ä¸ºä»€ä¹ˆä¸å»ºè®®ä½ ä½¿ç”¨SELECT_.html.ee5e1bb5.js"><link rel="prefetch" href="/assets/ä»æ ¹å„¿ä¸Šç†è§£ç´¢å¼•.html.c7e89f33.js"><link rel="prefetch" href="/assets/BIOä¸éé˜»å¡IO.html.56cc747b.js"><link rel="prefetch" href="/assets/index.html.9d93e6d0.js"><link rel="prefetch" href="/assets/RedisæŒä¹…åŒ–â€”â€”AOF.html.3ef66ec5.js"><link rel="prefetch" href="/assets/RedisæŒä¹…åŒ–â€”â€”RDB.html.956f2216.js"><link rel="prefetch" href="/assets/é¸¡è‚‹çš„Redisäº‹åŠ¡.html.bf1172f2.js"><link rel="prefetch" href="/assets/index.html.ccdcd4de.js"><link rel="prefetch" href="/assets/ä»0åˆ°1ç¼–å†™ä¸€æ¬¾æ’ä»¶.html.5f51ccf3.js"><link rel="prefetch" href="/assets/index.html.530ae07a.js"><link rel="prefetch" href="/assets/å¦‚ä½•åŒæ­¥é…ç½®.html.21989554.js"><link rel="prefetch" href="/assets/404.html.4285bac5.js"><link rel="prefetch" href="/assets/index.html.6717b2b6.js"><link rel="prefetch" href="/assets/index.html.5eae9e3f.js"><link rel="prefetch" href="/assets/index.html.85231e1c.js"><link rel="prefetch" href="/assets/index.html.07ef0efd.js"><link rel="prefetch" href="/assets/index.html.e5d6f701.js"><link rel="prefetch" href="/assets/index.html.accaa64c.js"><link rel="prefetch" href="/assets/index.html.9a9f30d6.js"><link rel="prefetch" href="/assets/index.html.68e6d714.js"><link rel="prefetch" href="/assets/index.html.b032f382.js"><link rel="prefetch" href="/assets/index.html.bc540566.js"><link rel="prefetch" href="/assets/index.html.4fa328ce.js"><link rel="prefetch" href="/assets/index.html.2c9f8626.js"><link rel="prefetch" href="/assets/index.html.6c184523.js"><link rel="prefetch" href="/assets/index.html.2309c271.js"><link rel="prefetch" href="/assets/index.html.94d1334e.js"><link rel="prefetch" href="/assets/index.html.3e9b5a53.js"><link rel="prefetch" href="/assets/index.html.da976a01.js"><link rel="prefetch" href="/assets/index.html.843e0dc5.js"><link rel="prefetch" href="/assets/index.html.e6adfc22.js"><link rel="prefetch" href="/assets/index.html.a46272a6.js"><link rel="prefetch" href="/assets/index.html.e68eec84.js"><link rel="prefetch" href="/assets/index.html.c3c92e66.js"><link rel="prefetch" href="/assets/index.html.a1ffa21c.js"><link rel="prefetch" href="/assets/index.html.5c810edd.js"><link rel="prefetch" href="/assets/index.html.7b661157.js"><link rel="prefetch" href="/assets/index.html.a61ab275.js"><link rel="prefetch" href="/assets/index.html.cd04393b.js"><link rel="prefetch" href="/assets/index.html.6ea94130.js"><link rel="prefetch" href="/assets/index.html.938c47df.js"><link rel="prefetch" href="/assets/index.html.b6e53603.js"><link rel="prefetch" href="/assets/index.html.abfe5d6e.js"><link rel="prefetch" href="/assets/index.html.799762a8.js"><link rel="prefetch" href="/assets/index.html.6a1f2c2a.js"><link rel="prefetch" href="/assets/index.html.91d708f1.js"><link rel="prefetch" href="/assets/index.html.2b208795.js"><link rel="prefetch" href="/assets/index.html.970ad9a6.js"><link rel="prefetch" href="/assets/index.html.18750c91.js"><link rel="prefetch" href="/assets/index.html.5832ab43.js"><link rel="prefetch" href="/assets/index.html.46963a2e.js"><link rel="prefetch" href="/assets/index.html.d8d0f261.js"><link rel="prefetch" href="/assets/index.html.656424fd.js"><link rel="prefetch" href="/assets/index.html.740f6c3e.js"><link rel="prefetch" href="/assets/index.html.75361b30.js"><link rel="prefetch" href="/assets/index.html.77d7aba9.js"><link rel="prefetch" href="/assets/index.html.c6475c4b.js"><link rel="prefetch" href="/assets/index.html.4f4df111.js"><link rel="prefetch" href="/assets/index.html.2ef7b821.js"><link rel="prefetch" href="/assets/index.html.0dc0a64e.js"><link rel="prefetch" href="/assets/index.html.8bde1faf.js"><link rel="prefetch" href="/assets/index.html.a8e5dab4.js"><link rel="prefetch" href="/assets/index.html.8dbe4bd2.js"><link rel="prefetch" href="/assets/index.html.72d090a7.js"><link rel="prefetch" href="/assets/index.html.f0f01938.js"><link rel="prefetch" href="/assets/index.html.899ba14c.js"><link rel="prefetch" href="/assets/index.html.1aac5a85.js"><link rel="prefetch" href="/assets/index.html.00e1e5ed.js"><link rel="prefetch" href="/assets/index.html.79aed47e.js"><link rel="prefetch" href="/assets/index.html.d40b22a3.js"><link rel="prefetch" href="/assets/index.html.50661535.js"><link rel="prefetch" href="/assets/index.html.47d81d31.js"><link rel="prefetch" href="/assets/index.html.3bf9cde9.js"><link rel="prefetch" href="/assets/index.html.e74f3868.js"><link rel="prefetch" href="/assets/home.html.0a39e1ac.js"><link rel="prefetch" href="/assets/update.html.d41a36d3.js"><link rel="prefetch" href="/assets/index.html.8ce6c1a4.js"><link rel="prefetch" href="/assets/index.html.d892d4ca.js"><link rel="prefetch" href="/assets/disable.html.feca1227.js"><link rel="prefetch" href="/assets/encrypt.html.6dd1693a.js"><link rel="prefetch" href="/assets/markdown.html.90c57cc5.js"><link rel="prefetch" href="/assets/JVMåˆ°åº•è¯¥å­¦ä¹ äº›ä»€ä¹ˆ.html.748dcca7.js"><link rel="prefetch" href="/assets/index.html.0f2c8809.js"><link rel="prefetch" href="/assets/æˆ‘æ˜¯ä¸€ä¸ªåƒåœ¾.html.c2dedb53.js"><link rel="prefetch" href="/assets/CPUæµæ°´çº¿ä¸æŒ‡ä»¤é‡æ’åº.html.d6501987.js"><link rel="prefetch" href="/assets/index.html.cc293dbb.js"><link rel="prefetch" href="/assets/ç”¨ã€Œé—ªç”µä¾ ã€è§£é‡Šä¸€ä¸‹è¿›ç¨‹å’Œçº¿ç¨‹.html.ff47218f.js"><link rel="prefetch" href="/assets/ç¼“å­˜ä¸€è‡´æ€§ä¸å†…å­˜å±éšœ.html.7cb837f2.js"><link rel="prefetch" href="/assets/index.html.b6c692db.js"><link rel="prefetch" href="/assets/network-programming.html.ad789019.js"><link rel="prefetch" href="/assets/index.html.36d79926.js"><link rel="prefetch" href="/assets/ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦.html.03a9134e.js"><link rel="prefetch" href="/assets/index.html.403eaf64.js"><link rel="prefetch" href="/assets/åŠ¨æ€ä»£ç†æ¨¡å¼.html.3382a4fc.js"><link rel="prefetch" href="/assets/å•ä¾‹æ¨¡å¼.html.e398af04.js"><link rel="prefetch" href="/assets/å·¥å‚æ¨¡å¼.html.1c29f15f.js"><link rel="prefetch" href="/assets/é™æ€ä»£ç†æ¨¡å¼.html.e9a9e65e.js"><link rel="prefetch" href="/assets/ä¾èµ–å€’ç½®åŸåˆ™.html.cfed4972.js"><link rel="prefetch" href="/assets/å¼€é—­åŸåˆ™.html.07c917ad.js"><link rel="prefetch" href="/assets/Googleæœç´¢ä¸ºä»€ä¹ˆä¸èƒ½æ— é™åˆ†é¡µï¼Ÿ.html.5218b4cb.js"><link rel="prefetch" href="/assets/index.html.3bef9268.js"><link rel="prefetch" href="/assets/m1èŠ¯ç‰‡ç”µè„‘å®‰è£…cerebro.html.c79f4590.js"><link rel="prefetch" href="/assets/MySQLä¸Redisçš„æ•°æ®ä¸€è‡´æ€§.html.650683c4.js"><link rel="prefetch" href="/assets/MySQLä¼˜åŒ–çš„5ä¸ªç»´åº¦.html.dd276592.js"><link rel="prefetch" href="/assets/MySQLç´¢å¼•çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿.html.e43a936b.js"><link rel="prefetch" href="/assets/MySQLé”å¼€ç¯‡.html.4312417c.js"><link rel="prefetch" href="/assets/index.html.52fbf30e.js"><link rel="prefetch" href="/assets/ä¸€æ¡SELECTè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.e56c6d3a.js"><link rel="prefetch" href="/assets/ä¸€æ¡Updateè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.2b765326.js"><link rel="prefetch" href="/assets/ä¸ºä»€ä¹ˆMySQLçš„ä¸»é”®æŸ¥è¯¢è¿™ä¹ˆå¿«.html.03d68e34.js"><link rel="prefetch" href="/assets/ä¸ºä»€ä¹ˆä¸å»ºè®®ä½ ä½¿ç”¨SELECT_.html.ebd9fc69.js"><link rel="prefetch" href="/assets/ä»æ ¹å„¿ä¸Šç†è§£ç´¢å¼•.html.4762ba49.js"><link rel="prefetch" href="/assets/BIOä¸éé˜»å¡IO.html.823dc552.js"><link rel="prefetch" href="/assets/index.html.8baf2f95.js"><link rel="prefetch" href="/assets/RedisæŒä¹…åŒ–â€”â€”AOF.html.8c06f00f.js"><link rel="prefetch" href="/assets/RedisæŒä¹…åŒ–â€”â€”RDB.html.cd286dc6.js"><link rel="prefetch" href="/assets/é¸¡è‚‹çš„Redisäº‹åŠ¡.html.a67a50d1.js"><link rel="prefetch" href="/assets/index.html.12b16d58.js"><link rel="prefetch" href="/assets/ä»0åˆ°1ç¼–å†™ä¸€æ¬¾æ’ä»¶.html.eb3c5add.js"><link rel="prefetch" href="/assets/index.html.6b7245a5.js"><link rel="prefetch" href="/assets/å¦‚ä½•åŒæ­¥é…ç½®.html.4cf3e6c5.js"><link rel="prefetch" href="/assets/404.html.4e4be11b.js"><link rel="prefetch" href="/assets/index.html.45b7f9f7.js"><link rel="prefetch" href="/assets/index.html.d093923a.js"><link rel="prefetch" href="/assets/index.html.8b820911.js"><link rel="prefetch" href="/assets/index.html.e7ad23bc.js"><link rel="prefetch" href="/assets/index.html.fe1df11a.js"><link rel="prefetch" href="/assets/index.html.7352c99f.js"><link rel="prefetch" href="/assets/index.html.c435077f.js"><link rel="prefetch" href="/assets/index.html.104d0f5c.js"><link rel="prefetch" href="/assets/index.html.f5585f62.js"><link rel="prefetch" href="/assets/index.html.ebbb496f.js"><link rel="prefetch" href="/assets/index.html.9050dd8e.js"><link rel="prefetch" href="/assets/index.html.66f49414.js"><link rel="prefetch" href="/assets/index.html.e930f19a.js"><link rel="prefetch" href="/assets/index.html.42c7bbbe.js"><link rel="prefetch" href="/assets/index.html.7285c2eb.js"><link rel="prefetch" href="/assets/index.html.bbaf227e.js"><link rel="prefetch" href="/assets/index.html.e3fde442.js"><link rel="prefetch" href="/assets/index.html.7c50d84e.js"><link rel="prefetch" href="/assets/index.html.b3cbffcd.js"><link rel="prefetch" href="/assets/index.html.62ee9702.js"><link rel="prefetch" href="/assets/index.html.2debbaa4.js"><link rel="prefetch" href="/assets/index.html.9dc8f507.js"><link rel="prefetch" href="/assets/index.html.09e7e8c2.js"><link rel="prefetch" href="/assets/index.html.5f069056.js"><link rel="prefetch" href="/assets/index.html.a7f1ae4f.js"><link rel="prefetch" href="/assets/index.html.30f1d7b9.js"><link rel="prefetch" href="/assets/index.html.1de98967.js"><link rel="prefetch" href="/assets/index.html.548d90ad.js"><link rel="prefetch" href="/assets/index.html.651110c2.js"><link rel="prefetch" href="/assets/index.html.45b71406.js"><link rel="prefetch" href="/assets/index.html.4f90b041.js"><link rel="prefetch" href="/assets/index.html.30234545.js"><link rel="prefetch" href="/assets/index.html.d2d34d0a.js"><link rel="prefetch" href="/assets/index.html.a9d78eed.js"><link rel="prefetch" href="/assets/index.html.0b7066f1.js"><link rel="prefetch" href="/assets/index.html.fa43fb4d.js"><link rel="prefetch" href="/assets/index.html.ddc062c2.js"><link rel="prefetch" href="/assets/index.html.8ba1f500.js"><link rel="prefetch" href="/assets/index.html.984619d2.js"><link rel="prefetch" href="/assets/index.html.23417bb8.js"><link rel="prefetch" href="/assets/index.html.2288b8be.js"><link rel="prefetch" href="/assets/index.html.4f7f5c89.js"><link rel="prefetch" href="/assets/index.html.588b3b32.js"><link rel="prefetch" href="/assets/index.html.13296de3.js"><link rel="prefetch" href="/assets/index.html.57925638.js"><link rel="prefetch" href="/assets/index.html.ba85260b.js"><link rel="prefetch" href="/assets/index.html.64083fff.js"><link rel="prefetch" href="/assets/index.html.004e7946.js"><link rel="prefetch" href="/assets/index.html.1e6478b4.js"><link rel="prefetch" href="/assets/index.html.c83a65ff.js"><link rel="prefetch" href="/assets/index.html.716585f3.js"><link rel="prefetch" href="/assets/index.html.4198b78d.js"><link rel="prefetch" href="/assets/index.html.76594791.js"><link rel="prefetch" href="/assets/index.html.902bd2bd.js"><link rel="prefetch" href="/assets/index.html.7f3fb562.js"><link rel="prefetch" href="/assets/index.html.c684ef10.js"><link rel="prefetch" href="/assets/index.html.75c631cf.js"><link rel="prefetch" href="/assets/index.html.def6ee32.js"><link rel="prefetch" href="/assets/index.html.3a471deb.js"><link rel="prefetch" href="/assets/index.html.9785d007.js"><link rel="prefetch" href="/assets/index.html.b25dc0cb.js"><link rel="prefetch" href="/assets/404.cb0b2bad.js"><link rel="prefetch" href="/assets/Layout.74ccbd97.js"><link rel="prefetch" href="/assets/Slide.d30de832.js"><link rel="prefetch" href="/assets/Blog.ae7c67e2.js"><link rel="prefetch" href="/assets/giscus.8fe73ced.js"><link rel="prefetch" href="/assets/auto.esm.2565cd3a.js"><link rel="prefetch" href="/assets/index.d8a59108.js"><link rel="prefetch" href="/assets/index.1842ee54.js"><link rel="prefetch" href="/assets/mermaid.esm.min.ee1e0284.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.218074cd.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="https://img-blog.csdnimg.cn/d16e11af2edb4972833f88083d2f0375.png" alt="è‰æ²é£"><!----><span class="site-name hide-in-pad">è‰æ²é£</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="ä¸»é¡µ"><span class="icon iconfont icon-home"></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æŠ€æœ¯åšæ–‡"><span class="title"><span class="icon iconfont icon-xieboke"></span>æŠ€æœ¯åšæ–‡</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å†…åŠŸå¿ƒæ³•</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/basic/design-pattern/" class="nav-link" aria-label="è®¾è®¡æ¨¡å¼"><span class="icon iconfont icon-design"></span>è®¾è®¡æ¨¡å¼<!----></a></li><li class="dropdown-subitem"><a href="/posts/basic/design-principle/%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99.html" class="nav-link" aria-label="è®¾è®¡åŸåˆ™"><span class="icon iconfont icon-design"></span>è®¾è®¡åŸåˆ™<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å­˜å‚¨ç¯‡</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/storage/MySQL" class="nav-link active" aria-label="MySQL"><span class="icon iconfont icon-mysql"></span>MySQL<!----></a></li><li class="dropdown-subitem"><a href="/posts/storage/Redis" class="nav-link" aria-label="Redis"><span class="icon iconfont icon-redis"></span>Redis<!----></a></li><li class="dropdown-subitem"><a href="/posts/storage/ElasticSearch" class="nav-link" aria-label="ElasticSearch"><span class="icon iconfont icon-elasticsearch-Elasticsearch"></span>ElasticSearch<!----></a></li></ul></li><li class="dropdown-item"><a href="/posts/concurrency" class="nav-link" aria-label="å¹¶å‘ç¯‡"><span class="icon iconfont icon-CPU"></span>å¹¶å‘ç¯‡<!----></a></li><li class="dropdown-item"><a href="/posts/JVM" class="nav-link" aria-label="JVM"><span class="icon iconfont icon-PCxuniji"></span>JVM<!----></a></li><li class="dropdown-item"><a href="/posts/os" class="nav-link" aria-label="Linux"><span class="icon iconfont icon-linux"></span>Linux<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å¼€å‘å·¥å…·"><span class="title"><span class="icon iconfont icon-keyboard"></span>å¼€å‘å·¥å…·</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/posts/tools/IDEA" class="nav-link" aria-label="IDEA"><span class="icon iconfont icon-jetbrains"></span>IDEA<!----></a></li><li class="dropdown-item"><a href="/posts/tools/VSCode" class="nav-link" aria-label="VSCode"><span class="icon iconfont icon-VsCode"></span>VSCode<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/posts/network-programming" class="nav-link" aria-label="socketç¼–ç¨‹"><span class="icon iconfont icon-wangluojiekou"></span>socketç¼–ç¨‹<!----></a></div><div class="nav-item hide-in-mobile"><a href="/update.html" class="nav-link" aria-label="æœ€è¿‘æ›´æ–°"><span class="icon iconfont icon-Update"></span>æœ€è¿‘æ›´æ–°<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://space.bilibili.com/519360358" rel="noopener noreferrer" target="_blank" aria-label class="nav-link"><span class="icon iconfont icon-bilibili"></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/chanmufeng/chanmufeng.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><div id="docsearch-container"></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><span class="icon iconfont icon-strong"></span><span class="title">1. åŸºç¡€ç¯‡</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/posts/storage/MySQL/%E4%B8%80%E6%9D%A1SELECT%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€æ¡SELECTè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„"><span class="icon iconfont icon-creative"></span>ä¸€æ¡SELECTè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/posts/storage/MySQL/%E4%B8%80%E6%9D%A1Update%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€æ¡UPDATEè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„"><span class="icon iconfont icon-creative"></span>ä¸€æ¡UPDATEè¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><span class="icon iconfont icon-condition"></span><span class="title">2. ç´¢å¼•ç¯‡</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/posts/storage/MySQL/%E4%B8%BA%E4%BB%80%E4%B9%88MySQL%E7%9A%84%E4%B8%BB%E9%94%AE%E6%9F%A5%E8%AF%A2%E8%BF%99%E4%B9%88%E5%BF%AB.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸ºä»€ä¹ˆMySQLçš„ä¸»é”®æŸ¥è¯¢è¿™ä¹ˆå¿«"><span class="icon iconfont icon-creative"></span>ä¸ºä»€ä¹ˆMySQLçš„ä¸»é”®æŸ¥è¯¢è¿™ä¹ˆå¿«<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/posts/storage/MySQL/%E4%BB%8E%E6%A0%B9%E5%84%BF%E4%B8%8A%E7%90%86%E8%A7%A3%E7%B4%A2%E5%BC%95.html" class="nav-link sidebar-link sidebar-page" aria-label="ä»æ ¹å„¿ä¸Šç†è§£ç´¢å¼•"><span class="icon iconfont icon-creative"></span>ä»æ ¹å„¿ä¸Šç†è§£ç´¢å¼•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/posts/storage/MySQL/MySQL%E7%B4%A2%E5%BC%95%E7%9A%84%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8%E5%A7%BF%E5%8A%BF.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQLç´¢å¼•çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿"><span class="icon iconfont icon-creative"></span>MySQLç´¢å¼•çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/posts/storage/MySQL/%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E5%BB%BA%E8%AE%AE%E4%BD%A0%E4%BD%BF%E7%94%A8SELECT*.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸ºä»€ä¹ˆä¸å»ºè®®ä½ ä½¿ç”¨SELECT*"><span class="icon iconfont icon-creative"></span>ä¸ºä»€ä¹ˆä¸å»ºè®®ä½ ä½¿ç”¨SELECT*<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading active"><span class="icon iconfont icon-lock"></span><span class="title">3. äº‹åŠ¡ä¸é”</span><!----></p><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="äº‹åŠ¡çš„éš”ç¦»æ€§ä¸MVCC"><span class="icon iconfont icon-creative"></span>äº‹åŠ¡çš„éš”ç¦»æ€§ä¸MVCC<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_1-äº‹åŠ¡-transaction-çš„èµ·æº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1. äº‹åŠ¡ï¼ˆtransactionï¼‰çš„èµ·æº"><!---->1. äº‹åŠ¡ï¼ˆtransactionï¼‰çš„èµ·æº<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_1-1-äº‹åŠ¡çš„å®šä¹‰" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.1. äº‹åŠ¡çš„å®šä¹‰"><!---->1.1. äº‹åŠ¡çš„å®šä¹‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_1-2-å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.2. å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡"><!---->1.2. å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-mysqlçš„äº‹åŠ¡è¯­æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2. MySQLçš„äº‹åŠ¡è¯­æ³•"><!---->2. MySQLçš„äº‹åŠ¡è¯­æ³•<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-1-è‡ªåŠ¨æäº¤" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.1. è‡ªåŠ¨æäº¤"><!---->2.1. è‡ªåŠ¨æäº¤<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-2-æ‰‹åŠ¨æ“ä½œäº‹åŠ¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.2. æ‰‹åŠ¨æ“ä½œäº‹åŠ¡"><!---->2.2. æ‰‹åŠ¨æ“ä½œäº‹åŠ¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-3-autocommitç³»ç»Ÿå˜é‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.3. autocommitç³»ç»Ÿå˜é‡"><!---->2.3. autocommitç³»ç»Ÿå˜é‡<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3. äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜"><!---->3. äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-1-è„è¯»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.1. è„è¯»"><!---->3.1. è„è¯»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-2-ä¸å¯é‡å¤è¯»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.2. ä¸å¯é‡å¤è¯»"><!---->3.2. ä¸å¯é‡å¤è¯»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-3-å¹»è¯»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.3. å¹»è¯»"><!---->3.3. å¹»è¯»<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_4-å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4. å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜"><!---->4. å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-sqlæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5. SQLæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«"><!---->5. SQLæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-1-ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1. ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«ï¼Ÿ"><!---->5.1. ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-2-è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2. è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘"><!---->5.2. è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-3-ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.3. ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«ï¼Ÿ"><!---->5.3. ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_6-mysqlæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6. MySQLæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«"><!---->6. MySQLæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_7-å†èŠè¡Œæ ¼å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7. å†èŠè¡Œæ ¼å¼"><!---->7. å†èŠè¡Œæ ¼å¼<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_7-1-ç®€æ˜“ç‰ˆè¡Œæ ¼å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.1. ç®€æ˜“ç‰ˆè¡Œæ ¼å¼"><!---->7.1. ç®€æ˜“ç‰ˆè¡Œæ ¼å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_7-2-åˆ†é…äº‹åŠ¡idçš„æ—¶æœº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.2. åˆ†é…äº‹åŠ¡idçš„æ—¶æœº"><!---->7.2. åˆ†é…äº‹åŠ¡idçš„æ—¶æœº<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_8-mvccç™»åœº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8. MVCCç™»åœº"><!---->8. MVCCç™»åœº<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_8-1-ç‰ˆæœ¬é“¾" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.1. ç‰ˆæœ¬é“¾"><!---->8.1. ç‰ˆæœ¬é“¾<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_8-2-readview" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.2. ReadView"><!---->8.2. ReadView<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/posts/storage/MySQL/MySQL%E9%94%81%E5%BC%80%E7%AF%87.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQLé”ï¼Œé”çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ"><span class="icon iconfont icon-creative"></span>MySQLé”ï¼Œé”çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><span class="icon iconfont icon-lock"></span><span class="title">4. æ•°æ®ä¸€è‡´æ€§</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/posts/storage/MySQL/MySQL%E4%B8%8ERedis%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7.html" class="nav-link sidebar-link sidebar-page" aria-label="å…ˆä¿®æ”¹MySQLè¿˜æ˜¯å…ˆä¿®æ”¹Redis"><span class="icon iconfont icon-creative"></span>å…ˆä¿®æ”¹MySQLè¿˜æ˜¯å…ˆä¿®æ”¹Redis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><span class="icon iconfont icon-cycle"></span><span class="title">5. ä¼˜åŒ–</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/posts/storage/MySQL/MySQL%E4%BC%98%E5%8C%96%E7%9A%845%E4%B8%AA%E7%BB%B4%E5%BA%A6.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQLä¼˜åŒ–çš„5ä¸ªç»´åº¦"><span class="icon iconfont icon-creative"></span>MySQLä¼˜åŒ–çš„5ä¸ªç»´åº¦<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-creative"></span>äº‹åŠ¡çš„éš”ç¦»æ€§ä¸MVCC</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´4æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.chanmufeng.com" target="_blank" rel="noopener noreferrer">è‰æ²é£</a></span><span property="author" content="è‰æ²é£"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´4æœˆ20æ—¥</span><meta property="datePublished" content="2022-04-20T00:00:00.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down" localizeddate="2022å¹´4æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category3 clickable" role="navigation">MySQL</li><meta property="articleSection" content="MySQL"></ul></span><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down" localizeddate="2022å¹´4æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag3 clickable" role="navigation">MySQL</li><li class="tag tag0 clickable" role="navigation">äº‹åŠ¡</li><li class="tag tag0 clickable" role="navigation">éš”ç¦»æ€§</li><li class="tag tag8 clickable" role="navigation">MVCC</li></ul><meta property="keywords" content="MySQL,äº‹åŠ¡,éš”ç¦»æ€§,MVCC"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2022å¹´4æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 32 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT32M"></span><!----><span class="words-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down" localizeddate="2022å¹´4æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 9563 å­—</span><meta property="wordCount" content="9563"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_1-äº‹åŠ¡-transaction-çš„èµ·æº" class="router-link-active router-link-exact-active toc-link level2">1. äº‹åŠ¡ï¼ˆtransactionï¼‰çš„èµ·æº</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_1-1-äº‹åŠ¡çš„å®šä¹‰" class="router-link-active router-link-exact-active toc-link level3">1.1. äº‹åŠ¡çš„å®šä¹‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_1-2-å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡" class="router-link-active router-link-exact-active toc-link level3">1.2. å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-mysqlçš„äº‹åŠ¡è¯­æ³•" class="router-link-active router-link-exact-active toc-link level2">2. MySQLçš„äº‹åŠ¡è¯­æ³•</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-1-è‡ªåŠ¨æäº¤" class="router-link-active router-link-exact-active toc-link level3">2.1. è‡ªåŠ¨æäº¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-2-æ‰‹åŠ¨æ“ä½œäº‹åŠ¡" class="router-link-active router-link-exact-active toc-link level3">2.2. æ‰‹åŠ¨æ“ä½œäº‹åŠ¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_2-3-autocommitç³»ç»Ÿå˜é‡" class="router-link-active router-link-exact-active toc-link level3">2.3. autocommitç³»ç»Ÿå˜é‡</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">3. äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-1-è„è¯»" class="router-link-active router-link-exact-active toc-link level3">3.1. è„è¯»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-2-ä¸å¯é‡å¤è¯»" class="router-link-active router-link-exact-active toc-link level3">3.2. ä¸å¯é‡å¤è¯»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_3-3-å¹»è¯»" class="router-link-active router-link-exact-active toc-link level3">3.3. å¹»è¯»</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_4-å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">4. å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-sqlæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active toc-link level2">5. SQLæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-1-ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active toc-link level3">5.1. ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-2-è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘" class="router-link-active router-link-exact-active toc-link level3">5.2. è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_5-3-ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«" class="router-link-active router-link-exact-active toc-link level3">5.3. ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_6-mysqlæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active toc-link level2">6. MySQLæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_7-å†èŠè¡Œæ ¼å¼" class="router-link-active router-link-exact-active toc-link level2">7. å†èŠè¡Œæ ¼å¼</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_7-1-ç®€æ˜“ç‰ˆè¡Œæ ¼å¼" class="router-link-active router-link-exact-active toc-link level3">7.1. ç®€æ˜“ç‰ˆè¡Œæ ¼å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_7-2-åˆ†é…äº‹åŠ¡idçš„æ—¶æœº" class="router-link-active router-link-exact-active toc-link level3">7.2. åˆ†é…äº‹åŠ¡idçš„æ—¶æœº</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_8-mvccç™»åœº" class="router-link-active router-link-exact-active toc-link level2">8. MVCCç™»åœº</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_8-1-ç‰ˆæœ¬é“¾" class="router-link-active router-link-exact-active toc-link level3">8.1. ç‰ˆæœ¬é“¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/storage/MySQL/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%80%A7%E4%B8%8EMVCC.html#_8-2-readview" class="router-link-active router-link-exact-active toc-link level3">8.2. ReadView</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><p>æåˆ°æ•°æ®åº“ï¼Œä½ å¤šåŠä¼šè”æƒ³åˆ°äº‹åŠ¡ï¼Œè¿›è€Œè¿˜å¯èƒ½æƒ³èµ·æ›¾ç»èƒŒå¾—æ»šç“œä¹±ç†Ÿçš„ACIDï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ³è¿‡è¿™ä¸ªé—®é¢˜ï¼Œäº‹åŠ¡æœ‰åŸå­æ€§ã€éš”ç¦»æ€§ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§å››å¤§ç‰¹æ€§ï¼Œä¸ºä»€ä¹ˆååç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«ï¼Ÿ</p><p><img src="http://qiniu.chanmufeng.com/2022-04-15-131827.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="è¢«éš”ç¦»çš„éš”ç¦»æ€§" loading="lazy"></p><p>ä¸€åˆ‡è¿˜å¾—ä»äº‹åŠ¡è¯´èµ·ã€‚</p><h2 id="_1-äº‹åŠ¡-transaction-çš„èµ·æº" tabindex="-1"><a class="header-anchor" href="#_1-äº‹åŠ¡-transaction-çš„èµ·æº" aria-hidden="true">#</a> 1. äº‹åŠ¡ï¼ˆtransactionï¼‰çš„èµ·æº</h2><p>å­¦ä¹ æ•°æ®åº“äº‹åŠ¡çš„æ—¶å€™ï¼Œä¸€ä¸ªå…¸å‹çš„æ¡ˆä¾‹å°±æ˜¯ã€Œè½¬è´¦ã€ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿä¸èƒ½å…ä¿—ï¼Œæ•…äº‹å°±ä»æ‹›è´¢å‘é™€èºå€Ÿ100å—é’±å¼€å§‹å§ã€‚</p><p>ä¸€ä¸ªçœ‹ä¼¼éå¸¸ç®€å•çš„ç°å®ä¸–ç•Œçš„çŠ¶æ€è½¬æ¢ï¼Œè½¬æ¢æˆæ•°æ®åº“ä¸­çš„æ“ä½œå´å¹¶æ²¡æœ‰é‚£ä¹ˆå•çº¯ã€‚è¿™ä¸ªçœ‹èµ·æ¥å¾ˆç®€å•çš„å€Ÿé’±æ“ä½œè‡³å°‘åŒ…å«äº†ä¸¤ä¸ªåŠ¨ä½œï¼š</p><ul><li>é™€èºçš„è´¦æˆ·ä½™é¢-100</li><li>æ‹›è´¢çš„è´¦æˆ·ä½™é¢+100</li></ul><p>è¦ä¿è¯è½¬è´¦æ“ä½œçš„æˆåŠŸï¼Œæ•°æ®åº“å¿…é¡»æŠŠè¿™ä¸¤ä¸ªæ“ä½œä½œä¸ºä¸€ä¸ªé€»è¾‘æ•´ä½“æ¥æ‰§è¡Œï¼Œè¿™ä¸ªé€»è¾‘æ•´ä½“å°±æ˜¯ä¸€ä¸ª<strong>äº‹åŠ¡</strong>ã€‚</p><h3 id="_1-1-äº‹åŠ¡çš„å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_1-1-äº‹åŠ¡çš„å®šä¹‰" aria-hidden="true">#</a> 1.1. äº‹åŠ¡çš„å®šä¹‰</h3><p><strong>äº‹åŠ¡</strong>å°±æ˜¯åŒ…å«æœ‰é™ä¸ªï¼ˆå•æ¡æˆ–å¤šæ¡ï¼‰æ•°æ®åº“æ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰çš„ã€æœ€å°çš„é€»è¾‘å·¥ä½œå•å…ƒï¼ˆä¸å¯å†åˆ†ï¼‰ã€‚</p><blockquote><p>è¯´åˆ°è¿™é‡Œä¸å¾—ä¸åæ§½ä¸€ä¸‹ï¼Œäº‹åŠ¡çš„è‹±æ–‡æ˜¯transactionï¼Œç›´è¯‘ä¸ºâ€œäº¤æ˜“â€çš„æ„æ€ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¢«æ„è¯‘æˆäº†â€œäº‹åŠ¡â€ï¼Œè®©äººå¾ˆéš¾ä»å­—é¢ä¸Šç†è§£è¿™ä¸ªæ¦‚å¿µçš„å«ä¹‰ã€‚</p><p>ä¸­å›½äººå¯¹ç¿»è¯‘çš„â€œä¿¡è¾¾é›…â€çš„åæ‰§åœ¨è®¡ç®—æœºé¢†åŸŸæˆ–å¤šæˆ–å°‘æœ‰ç‚¹ä¸è®¨å–œã€‚</p></blockquote><h3 id="_1-2-å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#_1-2-å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡" aria-hidden="true">#</a> 1.2. å“ªäº›å­˜å‚¨å¼•æ“æ”¯æŒäº‹åŠ¡</h3><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®åº“æˆ–è€…æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒäº‹åŠ¡ã€‚</p><p>å¯¹äºMySQLè€Œè¨€ï¼Œäº‹åŠ¡ä½œä¸ºä¸€ç§åŠŸèƒ½ç‰¹æ€§ç”±å­˜å‚¨å¼•æ“æä¾›ã€‚ç›®å‰æ”¯æŒäº‹åŠ¡åŠŸèƒ½çš„å­˜å‚¨å¼•æ“åªæœ‰<code>InnoDB</code>å’Œ<code>NDB</code>ï¼Œé‰´äº<code>InnoDB</code>ç›®å‰æ˜¯MySQLé»˜è®¤çš„å­˜å‚¨å¼•æ“ï¼Œæˆ‘ä»¬çš„ç ”ç©¶é‡ç‚¹è‡ªç„¶ä¹Ÿå°±æ˜¯<code>InnoDB</code>å­˜å‚¨å¼•æ“äº†ã€‚</p><p>å› æ­¤æ–‡ç« æ¥ä¸‹æ¥é»˜è®¤çš„å­˜å‚¨å¼•æ“å°±æ˜¯<code>InnoDB</code>ï¼Œç‰¹æ®Šæƒ…å†µä¸‹ä¼šç‰¹åˆ«æŒ‡å‡ºã€‚</p><p>é‚£ä¹ˆ<code>InnoDB</code>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼šå‡ºç°äº‹åŠ¡å‘¢ï¼Ÿ</p><h2 id="_2-mysqlçš„äº‹åŠ¡è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#_2-mysqlçš„äº‹åŠ¡è¯­æ³•" aria-hidden="true">#</a> 2. MySQLçš„äº‹åŠ¡è¯­æ³•</h2><p>å¦‚æœä½ ä¸æ˜¯DBAï¼Œåœ¨å¹³æ—¶å’ŒMySQLçš„äº¤äº’ä¸­ä½ å¯èƒ½æå°‘ç›´æ¥ä½¿ç”¨åˆ°å®ƒçš„äº‹åŠ¡è¯­æ³•ï¼Œä¸€åˆ‡éƒ½è¢«ç¼–ç¨‹æ¡†æ¶å°è£…å¾—å¾ˆå¥½äº†ã€‚ä½†æ˜¯ç°åœ¨æˆ‘ä»¬è¦ç›´æ¥ä½¿ç”¨MySQLè¿›è¡Œäº‹åŠ¡çš„ç ”ç©¶äº†ï¼ŒæŠ›å¼€æ¡†æ¶ï¼Œè·Ÿæˆ‘ç¨å¾®å›é¡¾ä¸€ä¸‹è¯­æ³•ï¼Œè¿™æ˜¯éå¸¸å¿…è¦çš„ã€‚</p><h3 id="_2-1-è‡ªåŠ¨æäº¤" tabindex="-1"><a class="header-anchor" href="#_2-1-è‡ªåŠ¨æäº¤" aria-hidden="true">#</a> 2.1. è‡ªåŠ¨æäº¤</h3><p>å½“æˆ‘è¿è¡Œè¿™æ ·å•ç‹¬ä¸€æ¡æ›´æ–°è¯­å¥çš„æ—¶å€™ï¼Œå®ƒä¼šæœ‰äº‹åŠ¡å—ï¼Ÿ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>UPDATE user_innodb SET name = &#39;è‰æ²é£&#39; WHERE id = 1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å®é™…ä¸Šï¼Œè¿™æ¡è¯­å¥ä¸ä»…ä¼šè‡ªåŠ¨å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè€Œä¸”æ‰§è¡Œå®Œæ¯•ä¹‹åè¿˜ä¼šè‡ªåŠ¨æäº¤äº‹åŠ¡ï¼Œå¹¶æŒä¹…åŒ–æ•°æ®ã€‚</p><p>è¿™æ˜¯MySQLé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ–¹å¼â€”â€”<strong>è‡ªåŠ¨æäº¤</strong>ã€‚åœ¨æ­¤æ–¹å¼ä¸‹ï¼Œå¢åˆ æ”¹çš„SQLè¯­å¥ä¼šè‡ªåŠ¨å¼€å¯äº‹åŠ¡ï¼Œå¹¶ä¸”æ˜¯ä¸€æ¡SQLä¸€ä¸ªäº‹åŠ¡ã€‚</p><p>è‡ªåŠ¨æäº¤çš„æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å¯¹äºè½¬è´¦è¿™ç§æ¶‰åŠåˆ°å¤šæ¡SQLçš„ä¸šåŠ¡ï¼Œå°±ä¸å¤ªé€‚åˆäº†ã€‚å› æ­¤ï¼ŒMySQLæä¾›äº†æ‰‹åŠ¨å¼€å¯äº‹åŠ¡çš„æ–¹æ³•ã€‚</p><h3 id="_2-2-æ‰‹åŠ¨æ“ä½œäº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#_2-2-æ‰‹åŠ¨æ“ä½œäº‹åŠ¡" aria-hidden="true">#</a> 2.2. æ‰‹åŠ¨æ“ä½œäº‹åŠ¡</h3><h4 id="_2-2-1-å¼€å¯äº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#_2-2-1-å¼€å¯äº‹åŠ¡" aria-hidden="true">#</a> 2.2.1. å¼€å¯äº‹åŠ¡</h4><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸¤ç§è¯­å¥å¼€å¯ä¸€ä¸ªäº‹åŠ¡</p><ul><li><code>BEGIN</code></li><li><code>START TRANSACTION</code></li></ul><blockquote><p>å¯¹æ¯”<code>BEGIN</code>è€Œè¨€ï¼Œ<code>START TRANSACTION</code>åé¢å¯ä»¥æ·»åŠ ä¸€äº›æ“ä½œç¬¦ï¼Œä¸è¿‡è¿™ä¸æ˜¯æˆ‘ä»¬çš„ç ”ç©¶é‡ç‚¹ï¼Œå¯ä»¥ä¸å¿…ç†ä¼šã€‚</p></blockquote><h4 id="_2-2-2-æäº¤æˆ–å›æ»š" tabindex="-1"><a class="header-anchor" href="#_2-2-2-æäº¤æˆ–å›æ»š" aria-hidden="true">#</a> 2.2.2. æäº¤æˆ–å›æ»š</h4><p>å¼€å¯äº‹åŠ¡ä¹‹åå°±å¯ä»¥ç»§ç»­ç¼–å†™éœ€è¦æ”¾åˆ°å½“å‰äº‹åŠ¡ä¸­çš„SQLè¯­å¥äº†ã€‚å½“å†™å®Œæœ€åä¸€æ¡è¯­å¥ï¼Œå¦‚æœä½ è§‰å¾—å†™å¾—æ²¡é—®é¢˜ï¼Œä½ å¯ä»¥æäº¤äº‹åŠ¡ï¼›åä¹‹ä½ åæ‚”äº†ï¼Œæƒ³æŠŠæ•°æ®åº“æ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œä½ å¯ä»¥å›æ»šäº‹åŠ¡ã€‚</p><ul><li>æäº¤äº‹åŠ¡ <code>COMMIT</code></li><li>å›æ»šäº‹åŠ¡ <code>ROLLBACK</code></li></ul><h3 id="_2-3-autocommitç³»ç»Ÿå˜é‡" tabindex="-1"><a class="header-anchor" href="#_2-3-autocommitç³»ç»Ÿå˜é‡" aria-hidden="true">#</a> 2.3. autocommitç³»ç»Ÿå˜é‡</h3><p>MySQLæä¾›äº†ä¸€ä¸ªå«åš<code>autocommit</code>çš„ç³»ç»Ÿå˜é‡ï¼Œç”¨æ¥è¡¨ç¤ºæ˜¯å¦å¼€å¯è‡ªåŠ¨æäº¤ï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; SHOW VARIABLES LIKE &#39;autocommit&#39;;
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| autocommit    | ON    |
+---------------+-------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>autocommit</code>çš„é»˜è®¤å€¼ä¸º<code>ON</code>ï¼Œè¡¨ç¤ºé»˜è®¤å¼€å¯è‡ªåŠ¨æäº¤ã€‚ä½†æ˜¯è‡ªåŠ¨æäº¤å’Œæ‰‹åŠ¨æ“ä½œäº‹åŠ¡å¹¶ä¸å†²çªï¼Œå¦‚æœä¸æ˜¾å¼ä½¿ç”¨<code>BEGIN</code>æˆ–<code>START TRANSACTION</code>å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆInnoDBä¼šåœ¨æ¯ä¸€æ¡å¢åˆ æ”¹è¯­å¥æ‰§è¡Œä¹‹åæäº¤äº‹åŠ¡ã€‚</p><p>å¦‚æœæˆ‘ä»¬æŠŠ<code>autocommit</code>è®¾ä¸º<code>OFF</code>ï¼Œé™¤éæˆ‘ä»¬æ‰‹åŠ¨ä½¿ç”¨<code>BEGIN</code>æˆ–<code>START TRANSACTION</code>å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå¦åˆ™InnoDBç»ä¸ä¼šè‡ªåŠ¨å¼€å¯äº‹åŠ¡ï¼›åŒæ ·ï¼Œé™¤éæˆ‘ä»¬ä½¿ç”¨<code>COMMIT</code>æˆ–<code>ROLLBACK</code>æäº¤æˆ–å›æ»šäº‹åŠ¡ï¼Œå¦åˆ™InnoDBä¸ä¼šè‡ªåŠ¨ç»“æŸäº‹åŠ¡ã€‚</p><blockquote><p>å®é™…ä¸Šï¼ŒInnoDBä¼šå› ä¸º<strong>æŸäº›ç‰¹æ®Šè¯­å¥çš„æ‰§è¡Œ</strong>æˆ–<strong>å®¢æˆ·ç«¯è¿æ¥æ–­å¼€</strong>ç­‰ç‰¹æ®Šæƒ…å†µè€Œå¯¼è‡´äº‹åŠ¡è‡ªåŠ¨æäº¤ï¼ˆå³ä½¿æˆ‘ä»¬æ²¡æœ‰æ‰‹åŠ¨è¾“å…¥<code>COMMIT</code>ï¼‰ï¼Œè¿™ç§æƒ…å†µå«åš<strong>éšå¼æäº¤</strong>ã€‚</p></blockquote><h2 id="_3-äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_3-äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜" aria-hidden="true">#</a> 3. äº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„è¯»é—®é¢˜</h2><p>MySQLä¼šä½¿ç”¨ç‹¬ç«‹çš„çº¿ç¨‹å¤„ç†æ¯ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œè¿™å°±æ˜¯å¤šçº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥å¼€å¯äº‹åŠ¡ï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„å¹¶å‘ã€‚</p><p>ä¸ç®¡æ˜¯å¤šçº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œè¿˜æ˜¯äº‹åŠ¡çš„å¹¶å‘æ‰§è¡Œï¼ˆå…¶å®æœ¬è´¨ä¸Šæ˜¯ä¸€å›äº‹å„¿ï¼‰ï¼Œå¦‚æœä¸é‡‡å–ç‚¹æªæ–½ï¼Œéƒ½ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ã€‚</p><h3 id="_3-1-è„è¯»" tabindex="-1"><a class="header-anchor" href="#_3-1-è„è¯»" aria-hidden="true">#</a> 3.1. è„è¯»</h3><p>å‡è®¾äº‹åŠ¡<code>T1</code>å’Œ<code>T2</code>å¹¶å‘æ‰§è¡Œï¼Œéƒ½è¦è®¿é—®<code>user_innodb</code>è¡¨ä¸­<code>id</code>ä¸º<code>1</code>çš„æ•°æ®ï¼Œä¸åŒçš„æ˜¯<code>T1</code>å…ˆè¯»å–æ•°æ®ï¼Œç´§æ¥ç€<code>T2</code>ä¿®æ”¹äº†æ•°æ®çš„<code>name</code>å­—æ®µï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>T2</code>å¹¶æ²¡æœ‰æäº¤ï¼</p><p><img src="http://qiniu.chanmufeng.com/2022-04-18-062617.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220418142616460" loading="lazy"></p><p>æ­¤æ—¶ï¼Œ<code>T1</code>å†æ¬¡æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ“ä½œï¼Œä¼šå‘ç°æ•°æ®å‘ç”Ÿäº†å˜åŒ–ï¼Œ<code>name</code>å­—æ®µç”±ã€Œç‹åˆšè›‹ã€å˜æˆäº†ã€Œè‰æ²é£ã€ã€‚</p><p>å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ª<strong>æœªæäº¤äº‹åŠ¡</strong>ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œè€Œå¯¼è‡´äº†å‰åä¸¤æ¬¡è¯»å–çš„æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼Œè¿™ç§äº‹åŠ¡å¹¶å‘é—®é¢˜å«åš<strong>è„è¯»</strong>ã€‚</p><h3 id="_3-2-ä¸å¯é‡å¤è¯»" tabindex="-1"><a class="header-anchor" href="#_3-2-ä¸å¯é‡å¤è¯»" aria-hidden="true">#</a> 3.2. ä¸å¯é‡å¤è¯»</h3><p>åŒæ ·æ˜¯<code>T1</code>å’Œ<code>T2</code>ä¸¤ä¸ªäº‹åŠ¡ï¼Œ<code>T1</code>é€šè¿‡<code>id=1</code>æŸ¥è¯¢åˆ°äº†ä¸€æ¡æ•°æ®ï¼Œç„¶å<code>T2</code>ç´§æ¥ç€<code>UPDATE</code>ï¼ˆ<code>DELETE</code>ä¹Ÿå¯ä»¥ï¼‰äº†è¯¥æ¡è®°å½•ï¼Œä¸åŒçš„æ˜¯ï¼Œ<code>T2</code>ç´§æ¥ç€é€šè¿‡<code>COMMIT</code>æäº¤äº†äº‹åŠ¡ã€‚</p><p><img src="http://qiniu.chanmufeng.com/2022-04-18-064329.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220418144329110" loading="lazy"></p><p>æ­¤æ—¶ï¼Œ<code>T1</code>å†æ¬¡æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ“ä½œï¼Œä¼šå‘ç°æ•°æ®å‘ç”Ÿäº†å˜åŒ–ï¼Œ<code>name</code>å­—æ®µç”±ã€Œç‹åˆšè›‹ã€å˜æˆäº†ã€Œè‰æ²é£ã€ã€‚</p><p>å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ª<strong>å·²æäº¤äº‹åŠ¡</strong>ä¿®æ”¹è¿‡çš„ï¼ˆæˆ–è€…æ˜¯åˆ é™¤çš„ï¼‰æ•°æ®ï¼Œè€Œå¯¼è‡´äº†å‰åä¸¤æ¬¡è¯»å–çš„æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼Œè¿™ç§äº‹åŠ¡å¹¶å‘é—®é¢˜å«åš<strong>ä¸å¯é‡å¤è¯»</strong>ã€‚</p><p>çœ‹åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯æœ‰ç‚¹æ‡µäº†ï¼Ÿæ€ä¹ˆè¯»åˆ°æœªæäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®æ˜¯å¹¶å‘é—®é¢˜ï¼Œè¯»åˆ°å·²æäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®è¿˜æ˜¯å¹¶å‘é—®é¢˜å‘¢ï¼Ÿ</p><p>è¿™é‡Œå…ˆä¸æ€¥ç€å›ç­”ä½ ï¼Œå› ä¸ºè¿˜æœ‰ä¸ªå¹»è¯»å‘¢ã€‚</p><h3 id="_3-3-å¹»è¯»" tabindex="-1"><a class="header-anchor" href="#_3-3-å¹»è¯»" aria-hidden="true">#</a> 3.3. å¹»è¯»</h3><p>è¿˜æ˜¯<code>T1</code>å’Œ<code>T2</code>è¿™ä¿©è´§ï¼Œ<code>T1</code>å…ˆæŸ¥æ‰¾äº†æ‰€æœ‰<code>name</code>ä¸ºã€Œç‹åˆšè›‹ã€çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ­¤æ—¶å‘ç°æ‹¥æœ‰è¿™ä¸ªç¡¬æ±‰åå­—çš„ç”¨æˆ·åªæœ‰ä¸€ä¸ªã€‚ç„¶å<code>T2</code>æ’å…¥äº†ä¸€ä¸ªåŒæ ·å«åšã€Œç‹åˆšè›‹ã€çš„ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¹¶ä¸”æäº¤äº†ã€‚</p><p><img src="http://qiniu.chanmufeng.com/2022-04-18-070817.png" alt="image-20220418150817586" loading="lazy"></p><p>æ­¤æ—¶ï¼Œ<code>T1</code>å†æ¬¡æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ“ä½œï¼Œå‘ç°ç›¸æ¯”ä¸Šæ¬¡çš„æŸ¥è¯¢ç»“æœå¤šäº†ä¸€è¡Œæ•°æ®ï¼Œä¸ç”±å¾—æ€€ç–‘è‡ªå·±æ˜¯ä¸æ˜¯å‡ºäº†å¹»è§‰ã€‚</p><p>å¦‚æœä¸€ä¸ªäº‹åŠ¡é¦–å…ˆæ ¹æ®æŸäº›æœç´¢æ¡ä»¶PæŸ¥è¯¢å‡ºä¸€äº›ç»“æœï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å†™å…¥ï¼ˆå¯ä»¥æ˜¯<code>INSERT</code>ï¼Œ<code>UPDATE</code>ï¼‰äº†ä¸€äº›ç¬¦åˆæœç´¢æ¡ä»¶Pçš„æ•°æ®ï¼Œæ­¤æ—¶å‰ä¸€ä¸ªäº‹åŠ¡å†æ¬¡è¯»å–ç¬¦åˆæ¡ä»¶Pçš„è®°å½•æ—¶å°±ä¼šè·å–åˆ°ä¹‹å‰æ²¡æœ‰è¯»å–è¿‡çš„è®°å½•ã€‚è¿™ä¸ªç°è±¡å«åš<strong>å¹»è¯»</strong>ã€‚</p><h2 id="_4-å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_4-å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜" aria-hidden="true">#</a> 4. å›ç­”ä¸€äº›å¯èƒ½å­˜åœ¨çš„é—®é¢˜</h2><p>ç°åœ¨æ˜¯ä¸­åœºç­”ç–‘æ—¶é—´ã€‚</p><blockquote><ol><li>ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°æœªæäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®ä¸è¡Œï¼Œè¯»åˆ°å·²æäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®ä¸ºä»€ä¹ˆè¿˜ä¸è¡Œï¼Ÿ</li></ol></blockquote><p>ä½ æ˜¯ä¸æ˜¯è§‰å¾—ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å…¶ä»–äº‹åŠ¡æœ€æ–°æäº¤çš„æ•°æ®æ˜¯ä¸€ç§æ­£å¸¸ç°è±¡ï¼Ÿæˆ–è€…è¯´åœ¨å¤šæ•°æƒ…å†µä¸‹è¿™æ˜¯æˆ‘ä»¬æœŸæœ›çš„ä¸€ç§è¡Œä¸ºï¼Ÿæ²¡é”™ï¼Œè¿™ç§ç°è±¡ç¡®å®æ˜¯æ­£å¸¸çš„ã€‚ä¸æ˜¯è¯´ä¸è¡Œï¼Œè€Œæ˜¯é’ˆå¯¹æˆ‘ä»¬è®¨è®ºçš„<strong>è¯»ä¸€è‡´æ€§</strong>é—®é¢˜ä¸Šï¼Œè¿™ä¸¤ç§ç°è±¡éƒ½ç®—æ˜¯å¹¶å‘é—®é¢˜ï¼Œå› ä¸ºè°ˆè¿™ä¸ªé—®é¢˜çš„æ—¶å€™æˆ‘ä»¬å·²ç»æŠŠè¯­å¢ƒå›ºå®šæ­»äº†ï¼Œå°±æ˜¯åœ¨<strong>åŒä¸€ä¸ªäº‹åŠ¡ä¸­</strong>çš„å‰åä¸¤æ¬¡<code>SELECT</code>çš„æ“ä½œç»“æœä¸è¯¥å’Œå…¶ä»–äº‹åŠ¡äº§ç”Ÿç“œè‘›ï¼Œå¦åˆ™å°±æ˜¯å‡ºç°äº†è¯»ä¸€è‡´æ€§é—®é¢˜ã€‚</p><blockquote><ol start="2"><li>æˆ‘åªå¬è¯´è¿‡äº‹åŠ¡çš„ä¸€è‡´æ€§ï¼Œæ²¡å¬è¯´è¿‡è¯»ä¸€è‡´æ€§</li></ol></blockquote><p>äº‹åŠ¡åœ¨å¹¶å‘æ‰§è¡Œæ—¶ä¸€å…±æœ‰ä¸‹é¢3ç§æƒ…å†µï¼š</p><ul><li>è¯»-è¯»ï¼šå¹¶å‘äº‹åŠ¡ç›¸ç»§è¯»å–ç›¸åŒè®°å½•ï¼Œç”±äºè¯»å–æ“ä½œæœ¬èº«ä¸ä¼šæ”¹å˜è®°å½•çš„å€¼ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹è‡ªç„¶ä¸ä¼šæœ‰å¹¶å‘é—®é¢˜ï¼›</li><li>è¯»-å†™/å†™-è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¿›è¡Œè¯»å–æ“ä½œï¼Œå¦ä¸€ä¸ªäº‹åŠ¡è¿›è¡Œå†™ï¼ˆå¢åˆ æ”¹ï¼‰æ“ä½œï¼›</li><li>å†™-å†™ï¼šå¹¶å‘äº‹åŠ¡ç›¸ç»§å¯¹ç›¸åŒè®°å½•è¿›è¡Œå†™ï¼ˆå¢åˆ æ”¹ï¼‰æ“ä½œã€‚</li></ul><p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ä¸Šä¸€èŠ‚çš„æ ‡é¢˜æ˜¯ã€Œäº‹åŠ¡å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„<strong>è¯»é—®é¢˜</strong>ã€ã€‚å¹¶ä¸”è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»éƒ½æ˜¯åœ¨è¯»-å†™/å†™-è¯»çš„æƒ…å†µä¸‹å‡ºç°çš„ï¼Œé‚£å†™-å†™æƒ…å†µæ€ä¹ˆåŠï¼Ÿ</p><p>ä¸€åˆ‡çš„å¹¶å‘é—®é¢˜éƒ½å¯ä»¥é€šè¿‡ä¸²è¡ŒåŒ–è§£å†³ï¼Œä½†æ˜¯ä¸²è¡ŒåŒ–æ•ˆç‡å¤ªä½äº†ï¼</p><p>å†ä¼˜åŒ–ä¸€ä¸‹ï¼Œä¸€åˆ‡å¹¶å‘é—®é¢˜éƒ½å¯ä»¥é€šè¿‡åŠ é”æ¥è§£å†³ï¼Œè¿™ç§æ–¹æ¡ˆæˆ‘ä»¬ç§°ä¸º<strong>åŸºäºé”çš„å¹¶å‘æ§åˆ¶</strong>ï¼ˆ<strong>Lock Bases Concurrency Control</strong>, <strong>LBCC</strong>ï¼‰ï¼ä½†æ˜¯åœ¨è¯»å¤šå†™å°‘çš„ç¯å¢ƒä¸‹ï¼Œå®¢æˆ·ç«¯è¿è¯»å–å‡ æ¡è®°å½•éƒ½éœ€è¦æ’é˜Ÿï¼Œæ•ˆç‡è¿˜æ˜¯å¤ªä½äº†ï¼</p><p>éš¾ä¸æˆæ•°æ®åº“æœ‰é¿å…ç»™è¯»æ“ä½œåŠ é”å°±å¯ä»¥è§£å†³ä¸€è‡´æ€§é—®é¢˜çš„æ–¹æ³•ï¼Ÿæ²¡é”™ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦è®²çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰æŠŠä¸€è‡´æ€§é—®é¢˜åˆ†ä¸ºè¯»ä¸€è‡´æ€§å’Œå†™ä¸€è‡´æ€§ï¼Œè€Œå†™ä¸€è‡´æ€§å°±å¾—ä¾èµ–æ•°æ®åº“çš„é”æœºåˆ¶äº†ã€‚</p><p>å¿ƒæ€¥åƒä¸äº†çƒ­è±†è…ï¼Œè¿™ç¯‡æ–‡ç« å…ˆç»™ä½ è®²æ˜ç™½è¯»ä¸€è‡´æ€§é—®é¢˜ã€‚</p><blockquote><ol start="3"><li>ä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„æœ€å¤§åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol></blockquote><p>è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆåœ¨ç½‘ä¸Šäº”èŠ±å…«é—¨ï¼Œè¦å›ç­”è¿™ä¸ªé—®é¢˜è‡ªç„¶è¦æ‰¾å®˜æ–¹äº†ã€‚è¿™ä¸ªå®˜æ–¹ä¸æ˜¯MySQLå®˜æ–¹ï¼Œè€Œæ˜¯ç¾å›½å›½å®¶æ ‡å‡†åä¼šï¼ˆANSIï¼‰ã€‚</p><p>æˆ‘ä»¬ä¸Šé¢è°ˆåˆ°çš„è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»é—®é¢˜éƒ½æ˜¯ç†è®ºçŸ¥è¯†ï¼Œå¹¶ä¸æ¶‰åŠåˆ°å…·ä½“çš„æ•°æ®åº“ã€‚è€ƒè™‘åˆ°æ‰€æœ‰æ•°æ®åº“åœ¨è®¾è®¡çš„è¿‡ç¨‹ä¸­éƒ½å¯èƒ½é‡åˆ°è¿™äº›é—®é¢˜ï¼ŒANSIå°±åˆ¶å®šäº†ä¸€ä¸ªSQLæ ‡å‡†ï¼Œå…¶ä¸­æœ€è‘—åçš„å°±æ˜¯<a href="http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt" target="_blank" rel="noopener noreferrer">SQL92æ ‡å‡†<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œå…¶ä¸­å®šä¹‰äº†ã€Œä¸å¯é‡å¤è¯»ã€å’Œã€Œå¹»è¯»ã€ï¼ˆå½“ç„¶ä¹Ÿå®šä¹‰äº†è„è¯»ï¼Œä½†é‰´äºæ²¡å•¥å¼‚è®®ï¼Œæˆ‘å°±æ²¡æˆªå›¾ï¼‰ï¼Œæˆ‘æŠŠå…¶ä¸­çš„é‡ç‚¹å•è¯ç»™å¤§å®¶æ ‡æ³¨äº†ä¸€ä¸‹ï¼Œå¸Œæœ›å¤§å®¶èƒ½å½»åº•ææ‡‚ä¸¤è€…çš„åŒºåˆ«ã€‚</p><p><img src="http://qiniu.chanmufeng.com/2022-04-18-093409.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220418173409077" loading="lazy"></p><p>æˆ‘ç”¨ä¸­æ–‡ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼š</p><p>ä¸å¯é‡å¤è¯»ï¼šäº‹åŠ¡<code>T1</code>è¯»å–äº†ä¸€æ¡è®°å½•ï¼Œäº‹åŠ¡<code>T2</code><strong>ä¿®æ”¹</strong>æˆ–è€…<strong>åˆ é™¤</strong>äº†åŒä¸€æ¡è®°å½•ï¼Œ<strong>å¹¶ä¸”æäº¤</strong>ã€‚å¦‚æœäº‹åŠ¡<code>T1</code>è¯•å›¾å†æ¬¡è¯»å–åŒä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œä¼šè¯»åˆ°è¢«äº‹åŠ¡<code>T2</code>ä¿®æ”¹çš„æ•°æ®æˆ–è€…å‹æ ¹è¯»ä¸åˆ°ã€‚</p><p>å¹»è¯»ï¼šäº‹åŠ¡<code>T1</code>é¦–å…ˆè¯»å–äº†ç¬¦åˆæŸäº›æœç´¢æ¡ä»¶Pçš„ä¸€äº›è®°å½•ã€‚ç„¶åäº‹åŠ¡<code>T2</code>æ‰§è¡Œäº†æŸäº›SQLè¯­å¥<strong>äº§ç”Ÿäº†</strong>ç¬¦åˆæœç´¢æ¡ä»¶Pçš„ä¸€æ¡æˆ–å¤šæ¡è®°å½•ã€‚å¦‚æœäº‹åŠ¡<code>T1</code>å†æ¬¡è¯»å–ç¬¦åˆæ¡ä»¶Pçš„è®°å½•ï¼Œå°†ä¼šå¾—åˆ°ä¸åŒäºä¹‹å‰çš„æ•°æ®é›†ã€‚</p><p>SQLæ ‡å‡†å¯¹äºä¸å¯é‡å¤è¯»å·²ç»è¯´å¾—å¾ˆæ¸…æ¥šäº†ï¼Œäº‹åŠ¡<code>T2</code>è¦å¯¹<code>T1</code>è¯»å–çš„è®°å½•è¿›è¡Œä¿®æ”¹æˆ–è€…åˆ é™¤æ“ä½œï¼Œå¹¶ä¸”å¿…é¡»è¦æäº¤äº‹åŠ¡ã€‚ä½†æ˜¯å¯¹äºå¹»è¯»çš„å®šä¹‰å°±è¯´å¾—å¾ˆæ¨¡ç³Šï¼Œå°¤å…¶æ˜¯æ–‡ä¸­ä½¿ç”¨äº†<code>generateï¼ˆç”Ÿæˆ/äº§ç”Ÿï¼‰</code>ï¼Œå†ç»“åˆ<code>one or more rows</code>ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºäº‹åŠ¡<code>T2</code>æ‰§è¡Œäº†<code>INSERT</code>è¯­å¥æ’å…¥äº†ä¹‹å‰æ²¡æœ‰è¯»åˆ°çš„è®°å½•ï¼Œæˆ–è€…æ˜¯æ‰§è¡Œäº†æ›´æ–°è®°å½•é”®å€¼çš„<code>UPDATE</code>è¯­å¥ç”Ÿæˆäº†ç¬¦åˆ<code>T1</code>ä¹‹å‰çš„æœç´¢æ¡ä»¶çš„è®°å½•ï¼Œæ€»ä¹‹åªè¦æ˜¯äº‹åŠ¡<code>T1</code>ä¹‹å‰æ²¡æœ‰è¯»åˆ°çš„æ•°æ®ï¼Œéƒ½ç®—æ˜¯å¹»å½±æ•°æ®ï¼Œè‡³äºäº‹åŠ¡<code>T2</code>éœ€ä¸éœ€è¦æäº¤å‹æ ¹å„¿æ²¡æã€‚</p><h2 id="_5-sqlæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_5-sqlæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> 5. SQLæ ‡å‡†ä¸4ç§éš”ç¦»çº§åˆ«</h2><p>å¦‚æœæŒ‰ç…§å¯¹ä¸€è‡´æ€§å½±å“çš„ä¸¥é‡ç¨‹åº¦ï¼Œå¯¹ä¸Šé¢æåˆ°çš„3ç§å¹¶å‘è¯»é—®é¢˜æ’ä¸ªåºçš„è¯ï¼Œå°±æ˜¯ä¸‹å›¾è¿™æ ·ï¼š</p><p><img src="http://qiniu.chanmufeng.com/2022-04-18-141703.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220418221702496" loading="lazy"></p><p>æˆ‘ä»¬åˆšæ‰ä¹Ÿæåˆ°äº†ï¼Œè¿™3ç§å¹¶å‘è¯»é—®é¢˜éƒ½æ˜¯ç†è®ºçŸ¥è¯†ï¼Œå¹¶ä¸æ¶‰åŠåˆ°å…·ä½“çš„æ•°æ®åº“ã€‚å› æ­¤SQLæ ‡å‡†å†æ¬¡å‘æŒ¥äº†ä½œç”¨ï¼Œä»–ä»¬å»ºè®®æ•°æ®åº“å‚å®¶æŒ‰ç…§ä»–ä»¬çš„è§„èŒƒï¼Œæä¾›ç»™ç”¨æˆ·4ç§éš”ç¦»çº§åˆ«ï¼Œè®©ç”¨æˆ·æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€è¦æƒè¡¡åˆ©å¼Šï¼Œé€‰æ‹©åˆé€‚çš„éš”ç¦»çº§åˆ«ï¼Œä»¥æ­¤è§£å†³æ‰€æœ‰çš„å¹¶å‘è¯»é—®é¢˜ï¼ˆè„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰æˆ–è€…å¯¹æŸäº›æ— å…³ç´§è¦çš„å¹¶å‘è¯»é—®é¢˜åšå‡ºå¦¥åã€‚</p><p>SQLæ ‡å‡†ä¸­å®šä¹‰çš„éš”ç¦»çº§åˆ«æœ‰å¦‚ä¸‹4ç§ï¼š</p><ul><li><code>READ UNCOMMITTED</code>ï¼šæœªæäº¤è¯»</li><li><code>READ COMMITTED</code>ï¼šå·²æäº¤è¯»</li><li><code>REPEATABLE READ</code>ï¼šå¯é‡å¤è¯»</li><li><code>SERIALIZABLE</code>ï¼šä¸²è¡ŒåŒ–</li></ul><p>SQLæ ‡å‡†ä¸­è§„å®šï¼Œé’ˆå¯¹ä¸åŒçš„éš”ç¦»çº§åˆ«ï¼Œå¹¶å‘äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥å‘ç”Ÿä¸åŒçš„å¹¶å‘è¯»é—®é¢˜ã€‚</p><p><img src="http://qiniu.chanmufeng.com/2022-04-18-145443.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220418225443159" loading="lazy"></p><p>å…¶ä¸­ç»¿è‰²ç®­å¤´è¡¨ç¤ºéš”ç¦»çº§åˆ«ç”±å¼±åˆ°å¼ºï¼Œçº¢è‰²ç®­å¤´è¡¨ç¤ºå¹¶å‘é—®é¢˜çš„ä¸¥é‡ç¨‹åº¦ç”±å¼±å˜å¼ºã€‚ç¿»è¯‘ä¸€ä¸‹ä¸Šé¢çš„è¡¨æ ¼å°±æ˜¯ï¼š</p><ul><li>åœ¨<code>READ UNCOMMITTED</code>éš”ç¦»çº§åˆ«ä¸‹ï¼Œè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»éƒ½æœ‰å¯èƒ½å‘ç”Ÿã€‚ä¹Ÿå°±æ˜¯è¿™ç§éš”ç¦»çº§åˆ«å•¥ä¹Ÿæ²¡å¹²ï¼›</li><li>åœ¨<code>READ COMMITTED</code>éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸å¯èƒ½å‘ç”Ÿè„è¯»ç°è±¡ï¼Œä½†æ˜¯ä¸å¯é‡å¤è¯»å’Œå¹»è¯»æœ‰å¯èƒ½å‘ç”Ÿï¼›</li><li>åœ¨<code>REPEATABLE READ</code>éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¯èƒ½å‘ç”Ÿå¹»è¯»ç°è±¡ï¼Œä½†æ˜¯ç»ä¸å¯èƒ½å‘ç”Ÿè„è¯»å’Œä¸å¯é‡å¤è¯»ï¼›</li><li>åœ¨<code>SERIALIZABLE</code>éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸Šè¿°æ‰€æœ‰ç°è±¡éƒ½ä¸å¯èƒ½å‘ç”Ÿã€‚</li></ul><p>è¯´å®Œè¿™äº›ï¼Œæœ‰äº›äººå¯èƒ½åƒå½“æ—¶çš„æˆ‘ä¸€æ ·ï¼Œä¾æ—§æ˜¯æ‡µçš„ã€‚ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«ï¼Ÿäº‹åŠ¡<code>T1</code>è¯»åˆ°å…¶ä»–äº‹åŠ¡æœ€æ–°ä¿®æ”¹çš„æ•°æ®éš¾é“ä¸å¥½å—ï¼Ÿä¸ºä»€ä¹ˆè¿™äº›éš”ç¦»çº§åˆ«çš„ä¸­æ–‡ç¿»è¯‘è¿™ä¹ˆè¹©è„šï¼Œæ„Ÿè§‰å¥½ä¸é€šé¡ºå•Šã€‚ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«ï¼Ÿ</p><h3 id="_5-1-ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_5-1-ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> 5.1. ä¸ºä»€ä¹ˆè¦è®¾ç½®éš”ç¦»çº§åˆ«ï¼Ÿ</h3><p>è¯´å®è¯ï¼Œæˆ‘è‡³ä»Šè¿˜æ²¡é‡åˆ°è¿‡éœ€è¦æˆ‘æ‰‹åŠ¨ä¿®æ”¹MySQLéš”ç¦»çº§åˆ«çš„ä¸šåŠ¡ï¼Œè€Œä¸”æˆ‘ä¹Ÿç›¸ä¿¡ï¼ŒçŸ­æ—¶é—´ä¹Ÿä¸ä¼šå‡ºç°è¿™ç§åœºæ™¯ã€‚æˆ‘ç›¸ä¿¡å¤§éƒ¨åˆ†å¼€å‘è€…ä¹Ÿæ˜¯ä¸€æ ·ã€‚å› æ­¤ï¼Œåœ¨æ²¡æœ‰æœºä¼šå®æˆ˜çš„æƒ…å†µä¸‹ï¼Œè¦èƒ½è®°ä½éš”ç¦»çº§åˆ«çš„è¿™ä¸ªæ¦‚å¿µï¼Œå¿…é¡»ä»éœ€æ±‚å‡ºå‘ï¼Œæ¥ç†è§£ä¸ºä»€ä¹ˆéœ€è¦éš”ç¦»çº§åˆ«ã€‚</p><p>æˆ‘ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªè´¦å•ç³»ç»Ÿï¼Œæ¯ä¸ªæœˆåº•éœ€è¦å¯¹ä½ æ‰€æœ‰çš„å®¢æˆ·çš„å€Ÿè´·æ“ä½œå’Œè´¦æˆ·ä½™é¢è¿›è¡Œå¯¹è´¦ã€‚å¯¹æ­¤ä½ å†™äº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯ä¸ªæœˆåˆ1å·çš„00:00:00æ—¶åˆ»å¼€å§‹å¯åŠ¨å¯¹è´¦ä¸šåŠ¡ï¼Œç”±äºæ˜¯åªå¯¹ä¸Šä¸ªæœˆçš„ä¸šåŠ¡è¿›è¡Œå¯¹è´¦ï¼Œæ‰€ä»¥è¯¥æ—¶åˆ»ä¹‹åæ‰€æœ‰çš„å¯¹è¯¥ç”¨æˆ·è´¦æˆ·çš„å†™æ“ä½œéƒ½ä¸åº”è¯¥å¯¹å¯¹è´¦äº‹åŠ¡çš„è¯»æ“ä½œå¯è§ã€‚</p><p>ç°åœ¨ä½ çŸ¥é“å¹¶ä¸æ˜¯ä»»ä½•æƒ…å†µä¸‹éƒ½è¦è¯»å–åˆ°æœ€æ–°ä¿®æ”¹çš„æ•°æ®äº†å§ã€‚</p><h3 id="_5-2-è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘" tabindex="-1"><a class="header-anchor" href="#_5-2-è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘" aria-hidden="true">#</a> 5.2. è¹©è„šçš„ä¸­æ–‡ç¿»è¯‘</h3><p>è‡³äºä¸­æ–‡è¹©è„šçš„é—®é¢˜ï¼Œçº¯å±æ˜¯æˆ‘ä¸ªäººæ£æµ‹çš„äº†ã€‚å› ä¸ºç›´åˆ°ç°åœ¨æˆ‘éƒ½è§‰å¾—éš”ç¦»çº§åˆ«çš„ä¸­æ–‡ç¿»è¯‘ä¸é¡ºå£ï¼Œå› æ­¤çŒœæµ‹å¯èƒ½è¯»è¿™ç¯‡æ–‡ç« çš„å…¶ä¸­ä¸€ä¸ªä½ ä¹Ÿä¼šå’Œæˆ‘æœ‰åŒæ ·çš„é—®é¢˜å‘¢ã€‚æˆ‘çš„åŠæ³•å°±æ˜¯ç›´æ¥ç”¨è‹±æ–‡ä»£æ›¿ä¸­æ–‡ç¿»è¯‘ï¼Œçº¯å±ä¸ªäººæ–¹æ³•ï¼Œä¸å¥½ä½¿ä¸è¦æ€ªæˆ‘ã€‚</p><h3 id="_5-3-ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_5-3-ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«" aria-hidden="true">#</a> 5.3. ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«ï¼Ÿ</h3><p>ç»ˆäºèŠåˆ°äº†ä¸ºä»€ä¹ˆå•å•ç»™éš”ç¦»æ€§è®¾ç½®äº†çº§åˆ«è¿™ä¸ªé—®é¢˜äº†ã€‚å¦‚æœæƒ³æƒ³äº‹åŠ¡çš„4ä¸ªç‰¹æ€§ï¼Œä¹Ÿå°±è‡ªç„¶æ˜ç™½è¿™ä¸ªé—®é¢˜äº†ã€‚</p><p><strong>åŸå­æ€§</strong></p><p>ç®€å•æ€»ç»“å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ä¸­çš„è¯­å¥ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ï¼Œä¸å…è®¸å­˜åœ¨ä¸­é—´çŠ¶æ€ã€‚æ‰€ä»¥å¯¹äºåŸå­æ€§æ²¡æœ‰çº§åˆ«å¯ä»¥è®¾ç½®ï¼Œæˆ‘ä»¬æ€»ä¸èƒ½æå‡ºè‡³å°‘æœ‰80%çš„SQLè¯­å¥æ‰§è¡ŒæˆåŠŸè¿™ç§æ— ç†çš„è¦æ±‚å§ã€‚</p><p><strong>ä¸€è‡´æ€§</strong></p><p>ä¸€è‡´æ€§æ˜¯äº‹åŠ¡çš„æœ€ç»ˆç›®æ ‡ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯æ•°æ®åº“çš„æ•°æ®æ“ä½œä¹‹åçš„æœ€ç»ˆç»“æœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œç¬¦åˆç°å®ä¸–ç•Œçš„è§„å®šã€‚æ¯”å¦‚ï¼Œé™€èºè´¦æˆ·é‡Œæœ‰100å—é’±ï¼Œæ‹›è´¢åˆ†æ–‡æ— æœ‰ï¼Œä¸ç®¡é™€èºå€Ÿç»™æ‹›è´¢å¤šå°‘æ¬¡ï¼Œæ‹›è´¢åˆ†æˆå¤šå°‘æ¬¡è¿˜ï¼Œä»–ä¿©çš„è´¦æˆ·æ€»é¢å¿…é¡»æ˜¯100ï¼Œæœ‰å€Ÿå¿…æœ‰è´·ï¼Œå€Ÿè´·å¿…ç›¸ç­‰ï¼Œè¿™å°±æ˜¯ä¸€è‡´æ€§ã€‚</p><p>å‘ƒã€‚ã€‚ã€‚å¥½åƒä¹Ÿæ²¡æ‰¾åˆ°å¯ä»¥å•†é‡å•†é‡æ‰“ä¸ªæŠ˜æ‰£çš„ç‚¹ã€‚</p><p><strong>æŒä¹…æ€§</strong></p><p>è¿™ä¸ªç‰¹æ€§æœ€ç®€å•ï¼Œå°±æ˜¯è¦æŠŠäº‹åŠ¡çš„æ‰€æœ‰å†™æ“ä½œæŒä¹…åŒ–åˆ°ç£ç›˜ã€‚æˆ‘ä»¬è‡ªç„¶ä¹Ÿä¸å¯èƒ½æå‡ºè‡³å°‘80%çš„å†™æ“ä½œè¢«æŒä¹…åŒ–åˆ°ç£ç›˜è¿™æ ·å‚»å…®å…®çš„è¦æ±‚å§ã€‚</p><p><strong>éš”ç¦»æ€§</strong></p><p>æˆ‘ä»¬å”¯ç‹¬å¯ä»¥åœ¨è¿™ä¸ªéš”ç¦»æ€§ä¸Šåšç‚¹æ‰‹è„šã€‚</p><p>ä»¥æ–°å† ç–«æƒ…ä¸ºä¾‹ã€‚ç–«æƒ…ç´§å¼ çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ€å¸¸å¬åˆ°çš„è¯å°±æ˜¯éš”ç¦»ï¼Œè™½ç„¶éƒ½æ˜¯éš”ç¦»ï¼Œå´æœ‰å±…å®¶éš”ç¦»ã€æ–¹èˆ±éš”ç¦»ã€é…’åº—å•é—´éš”ç¦»ä¹‹åˆ†ã€‚</p><p>å†ä¸¾ä¸ªä¾‹å­ï¼Œä½ å’Œé‚»å±…ä»¥å¢™ç›¸éš”ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆå¼ºçš„éš”ç¦»æ€§ã€‚ä½†æ˜¯æŸä¸€å¤©ï¼Œä½ å‡¿å£å·äº†ä¸ªå…‰ï¼Œä½ ä»¬ä¸¤å®¶ä¾ç„¶æ˜¯æœ‰éš”ç¦»æ€§çš„ï¼Œæ¯•ç«Ÿå¢™è¿˜åœ¨é‚£ç«‹ç€å‘¢ï¼Œä½†æ˜¯éš”ç¦»æ€§æ˜¾ç„¶æ²¡æœ‰åŸæ¥é‚£ä¹ˆå¼ºäº†ã€‚</p><p>è¯´åˆ°è¿™å„¿ï¼Œä¸çŸ¥é“ä½ ç†è§£äº†å—ï¼Ÿ</p><h2 id="_6-mysqlæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_6-mysqlæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> 6. MySQLæ”¯æŒçš„4ç§éš”ç¦»çº§åˆ«</h2><p>æ ‡å‡†å½’æ ‡å‡†ï¼Œä¸åŒçš„æ•°æ®åº“å‚å•†æˆ–è€…å­˜å‚¨å¼•æ“å¯¹æ ‡å‡†çš„å®ç°æœ‰ä¸€å®šçš„å·®å¼‚ã€‚æ¯”å¦‚Oracleæ•°æ®åº“åªæä¾›äº†<code>READ COMMITTED</code>å’Œ<code>SERIALIZABLE</code>ä¸¤ç§éš”ç¦»çº§åˆ«ã€‚</p><p>è¯´å›MySQLã€‚ InnoDBæ”¯æŒçš„4ä¸ªéš”ç¦»çº§åˆ«å’ŒSQLæ ‡å‡†å®šä¹‰çš„å®Œå…¨ä¸€è‡´ï¼Œéš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œäº‹åŠ¡çš„å¹¶å‘ç¨‹åº¦å°±è¶Šä½ï¼Œä½†æ˜¯å‡ºç°å¹¶å‘é—®é¢˜çš„æ¦‚ç‡å°±è¶Šå°ã€‚</p><p><img src="http://qiniu.chanmufeng.com/2022-04-19-064333.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220419144332647" loading="lazy"></p><p>ä¸Šå›¾ä¸­è¿˜æœ‰éå¸¸é‡è¦çš„ä¸€ç‚¹ï¼Œå°±æ˜¯InnoDBåœ¨<code>REPEATABLE READ</code>éš”ç¦»çº§åˆ«ä¸‹ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå°±è§£å†³äº†å¹»è¯»çš„é—®é¢˜ï¼Œè®©å¹»è¯»çš„å‘ç”Ÿæˆä¸ºä¸€ç§å°æ¦‚ç‡äº‹ä»¶ã€‚åœ¨è¿™ä¸€ç‚¹ä¸ŠInnoDBä¸ä»…å®Œæˆäº†SQLæ ‡å‡†ï¼Œä¸€å®šç¨‹åº¦ä¸Šä¹Ÿå¯ä»¥è¯´æ˜¯è¶…è¶Šäº†æ ‡å‡†ã€‚å› æ­¤ï¼Œ<code>REPEATABLE READ</code>ä¹Ÿæˆäº†InnoDBé»˜è®¤çš„éš”ç¦»çº§åˆ«ã€‚</p><p>é‚£ä»€ä¹ˆæ—¶å€™å¹»è¯»è¿˜ä¼šå‘ç”Ÿå‘¢ï¼Ÿæˆ‘ä¸¾ä¸ªä¾‹å­ã€‚æˆ‘ç”¨ä¸¤ä¸ªç»ˆç«¯åˆ†åˆ«å¼€å¯ä¸¤ä¸ªMySQLä¼šè¯ï¼Œæ¯ä¸ªä¼šè¯ä¸­å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶ä¸”ä¿è¯äº†æ¯ä¸ªä¼šè¯çš„äº‹åŠ¡éš”ç¦»çº§åˆ«éƒ½æ˜¯<code>REPEATABLE READ</code>ã€‚</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T1é¦–å…ˆå¼€å¯äº‹åŠ¡
mysql&gt; BEGIN;

# äº‹åŠ¡T1æœç´¢idä¸º1çš„è®°å½•ï¼Œç»“æœé›†ä¸ºç©º
mysql&gt; SELECT * FROM user_innodb WHERE id = 1;
Empty set (0.01 sec)

# äº‹åŠ¡T2æ’å…¥ä¸€æ¡idä¸º1çš„è®°å½•ï¼Œå¹¶ä¸”æäº¤äº‹åŠ¡
# INSERT INTO user_innodb VALUES(1,&#39;wanggangdan&#39;,0);
# COMMIT;

# äº‹åŠ¡T1åœ¨é‡æ–°æœç´¢ä¹‹å‰ï¼Œä¿®æ”¹ä¸€ä¸‹äº‹åŠ¡T2åˆšæ’å…¥çš„é‚£æ¡è®°å½•
mysql&gt; UPDATE user_innodb SET name = &#39;chanmufeng&#39; WHERE id = 1;
Query OK, 1 row affected (0.03 sec)

# äº‹åŠ¡T1å†æœç´¢idä¸º1çš„è®°å½•ï¼Œå‘ç°å¤šäº†ä¸€æ¡è®°å½•
mysql&gt; SELECT * FROM user_innodb WHERE id = 1;
+----+------------+--------+
| id | name       | gender |
+----+------------+--------+
|  1 | chanmufeng |      0 |
+----+------------+--------+
1 row in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦è¯´æ¸…æ¥šè¿™ä¸ªé—®é¢˜å°±ç‰µæ‰¯åˆ°MySQLé”çš„çŸ¥è¯†äº†ï¼Œè¿™ä¸ªä»¥åå†è¯´ï¼ŒçŸ¥é“è¿™ä¹ˆå›äº‹å„¿å°±è¡Œäº†ã€‚</p><p>å›åˆ°æˆ‘ä»¬çš„ä¸»çº¿ã€‚æˆ‘ä»¬ç°åœ¨æƒ³è®©äº‹åŠ¡åœ¨è‡ªå·±çš„ä¸€äº©ä¸‰åˆ†åœ°å„¿é‡Œéšä¾¿æŠ˜è…¾ï¼Œå…¶ä»–äº‹åŠ¡çš„å¢åˆ æ”¹æ“ä½œæˆ‘ä¸æƒ³çŸ¥é“ï¼ˆæˆ–è€…æˆ‘æƒ³çŸ¥é“ï¼Œå°±æ”¾å¼€ä¸€ä¸‹éš”ç¦»çº§åˆ«ï¼‰ã€‚æ€ä¹ˆåŠï¼Ÿ</p><p>æˆ–è®¸ä½ ç”¨è¿‡<code>git</code>ï¼Ÿ</p><p>æˆ‘ä»¬ç”¨<code>git</code>è¿›è¡Œå¼€å‘ä»»åŠ¡çš„æ—¶å€™ï¼Œé€šå¸¸æƒ…å†µä¸‹éƒ½ä¼šè‡ªå·±åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œåœ¨è‡ªå·±çš„åˆ†æ”¯ä¸Šå®Œæˆè‡ªå·±çš„ä»»åŠ¡ï¼Œè¿™æ ·å’Œå…¶ä»–å¼€å‘è€…ä¸ä¼šé€ æˆå†²çªã€‚æˆ‘ä»¬å¯ä»¥å€Ÿé‰´ä¸€ä¸‹è¿™ä¸ªæ€è·¯ã€‚</p><p><img src="http://qiniu.chanmufeng.com/2022-04-19-073628.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220419153627609" loading="lazy"></p><p><code>git</code>çš„æ¯ä¸ªåˆ†æ”¯éƒ½æœ‰ä¸€ä¸ªåˆ†æ”¯idï¼Œé‚£äº‹åŠ¡ä¹Ÿè¯¥æœ‰è‡ªå·±çš„å”¯ä¸€æ ‡è¯†å§ï¼Œè¿™æ˜¯è‡ªç„¶çš„ï¼Œä¸‹é¢ç¨å¾®å›é¡¾ä¸€ä¸‹è¡Œæ ¼å¼ã€‚</p><h2 id="_7-å†èŠè¡Œæ ¼å¼" tabindex="-1"><a class="header-anchor" href="#_7-å†èŠè¡Œæ ¼å¼" aria-hidden="true">#</a> 7. å†èŠè¡Œæ ¼å¼</h2><p>ä¸ºä»€ä¹ˆå«å†èŠï¼Ÿå› ä¸ºæˆ‘ä¹‹å‰å¥½å‡ ç¯‡æ–‡ç« éƒ½æåˆ°äº†è¡Œæ ¼å¼ï¼Œä½ è¦æ˜¯æ—©ç‚¹è¯»åˆ°é‚£å‡ ç¯‡æ–‡ç« ä¹Ÿå°±ä¸ç”¨æˆ‘å†è¯´ä¸€éäº†ã€‚ï¼ˆæ‰€ä»¥èµ¶ç´§å…³æ³¨æˆ‘å…¬ä¼—å·å•Šã€‚ã€‚ã€‚[æ—ºæŸ´]ï¼‰ã€‚</p><p>ä½†æ˜¯æ€»æœ‰äº›æ–°æœ‹å‹å˜›ã€‚</p><h3 id="_7-1-ç®€æ˜“ç‰ˆè¡Œæ ¼å¼" tabindex="-1"><a class="header-anchor" href="#_7-1-ç®€æ˜“ç‰ˆè¡Œæ ¼å¼" aria-hidden="true">#</a> 7.1. ç®€æ˜“ç‰ˆè¡Œæ ¼å¼</h3><p>ä½ å­˜å…¥MySQLçš„æ¯ä¸€æ¡è®°å½•éƒ½ä¼šä»¥æŸä¸€ç§MySQLæä¾›çš„è¡Œæ ¼å¼æ¥è¿›è¡Œå­˜å‚¨ï¼Œå…·ä½“æœ‰å“ªäº›è¡Œæ ¼å¼æˆ‘ä¸æ‰“ç®—è¯´æ˜ï¼Œä½ ä¹Ÿæ²¡å¿…è¦è®°ä½ï¼Œä»–ä»¬ä¹‹é—´çš„æœ€å¤§åŒºåˆ«åªæ˜¯å¯¹ç£ç›˜å ç”¨ç‡çš„ä¼˜åŒ–ç¨‹åº¦ä¸åŒç½¢äº†ã€‚</p><p>æˆ‘ä»¬æŠŠæ‰€æœ‰è¡Œæ ¼å¼çš„å…¬æœ‰éƒ¨åˆ†æ‹¿å‡ºæ¥ï¼Œæ€»ä¹‹ï¼Œä¸€æ¡ç”¨æˆ·æ•°æ®å¯ä»¥ç”¨ä¸‹é¢çš„å›¾æ¥è¡¨ç¤º</p><p><img src="http://qiniu.chanmufeng.com/2022-04-19-081339.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220419161338770" loading="lazy"></p><blockquote><p>æ³¨ï¼šå›¾ä¸­æ ‡è¯†çš„å­—æ®µé¡ºåºå’Œå®é™…MySQLçš„å­—æ®µå­˜å‚¨é¡ºåºå¹¶ä¸ä¸€è‡´ï¼Œè¿™æ ·ç”»æ˜¯ä¸ºäº†èƒ½æ›´æ¸…æ™°åœ°è¯´æ˜é—®é¢˜ã€‚</p></blockquote><ul><li><code>roll_pointer</code>ï¼šæ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥èŠçš„é‡ç‚¹ï¼Œè¿™é‡Œå…ˆä¸ç®¡å®ƒï¼›</li><li><code>trx_id</code>ï¼šå®ƒå°±æ˜¯äº‹åŠ¡idäº†ï¼Œæ¯æ¡ç”¨æˆ·è®°å½•éƒ½æœ‰è¿™ä¸ªå­—æ®µã€‚åƒä¸‡ä¸è¦å¿˜äº†ä¸€ä¸ªè‡³å…³é‡è¦çš„å‰æï¼Œæˆ‘ä»¬ç”¨çš„å­˜å‚¨å¼•æ“æ˜¯InnoDBï¼›</li><li>å…¶ä»–ï¼šå°±ä¸ç”¨å¤šè¯´äº†å§ã€‚</li></ul><h3 id="_7-2-åˆ†é…äº‹åŠ¡idçš„æ—¶æœº" tabindex="-1"><a class="header-anchor" href="#_7-2-åˆ†é…äº‹åŠ¡idçš„æ—¶æœº" aria-hidden="true">#</a> 7.2. åˆ†é…äº‹åŠ¡idçš„æ—¶æœº</h3><p>å¯¹äºè¯»å†™äº‹åŠ¡è€Œè¨€ï¼Œåªæœ‰åœ¨å®ƒç¬¬ä¸€æ¬¡å¯¹æŸä¸ªè¡¨è¿›è¡Œ<strong>å¢åˆ æ”¹</strong>æ“ä½œæ—¶ï¼Œæ‰ä¼šä¸ºè¿™ä¸ªäº‹åŠ¡åˆ†é…ä¸€ä¸ªäº‹åŠ¡idï¼Œå¦åˆ™ä¸ä¼šåˆ†é…ã€‚</p><p>æ›´ç‰¹æ®Šåœ°ï¼Œå¦‚æœä¸€ä¸ªè¯»å†™äº‹åŠ¡ä¸­å…¨æ˜¯æŸ¥è¯¢è¯­å¥ï¼Œæ²¡æœ‰å¢åˆ æ”¹çš„æ“ä½œï¼Œè¿™ä¸ªäº‹åŠ¡ä¹Ÿä¸ä¼šè¢«åˆ†é…äº‹åŠ¡idã€‚</p><p>å¦‚æœä¸åˆ†é…äº‹åŠ¡idï¼Œäº‹åŠ¡idçš„å€¼é»˜è®¤ä¸º<code>0</code>ã€‚</p><h2 id="_8-mvccç™»åœº" tabindex="-1"><a class="header-anchor" href="#_8-mvccç™»åœº" aria-hidden="true">#</a> 8. MVCCç™»åœº</h2><h3 id="_8-1-ç‰ˆæœ¬é“¾" tabindex="-1"><a class="header-anchor" href="#_8-1-ç‰ˆæœ¬é“¾" aria-hidden="true">#</a> 8.1. ç‰ˆæœ¬é“¾</h3><p>å½“ä¸€ä¸ªäº‹åŠ¡<code>T1</code>è¯»åˆ°äº†ä¸€æ¡è®°å½•ï¼Œæˆ‘ä»¬å½“ç„¶å¸Œæœ›èƒ½ç¦æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¯¥æ¡è®°å½•è¿›è¡Œä¿®æ”¹å’Œåˆ é™¤çš„æ“ä½œï¼Œç›´åˆ°<code>T1</code>ç»“æŸï¼Œä½†æ˜¯è¿™ç§æ»¡è¶³ä¸€å·±ä¹‹ç§çš„è¡Œä¸ºåœ¨å¹¶å‘é¢†åŸŸæ˜¯è¦é­åˆ°å”¾éª‚çš„ã€‚è¿™ä¸¥é‡æ‹–ç³»ç»Ÿåè…¿å•Šã€‚</p><p>äºæ˜¯InnoDBçš„è®¾è®¡è€…æå‡ºäº†ä¸€ç§å’Œ<code>git</code>ç±»ä¼¼çš„æƒ³æ³•ï¼Œæ¯å¯¹è®°å½•åšä¸€æ¬¡ä¿®æ”¹æ“ä½œï¼Œéƒ½è¦è®°å½•ä¸€æ¡ä¿®æ”¹ä¹‹å‰çš„æ—¥å¿—ï¼Œå¹¶ä¸”è¯¥æ—¥å¿—è¿˜ä¿å­˜äº†å½“å‰äº‹åŠ¡çš„idï¼Œå’Œè¡Œæ ¼å¼ç±»ä¼¼ï¼Œè¿™æ¡æ—¥å¿—ä¹Ÿæœ‰ä¸€ä¸ª<code>roll_pointer</code>èŠ‚ç‚¹ã€‚</p><blockquote><p>å®é™…InnoDBçš„è¿™ä¸ªåŠŸèƒ½å’Œgitæ²¡æœ‰åŠæ¯›é’±å…³ç³»ï¼Œè¿™é‡Œå•çº¯ä¸ºäº†ç±»æ¯”ã€‚</p></blockquote><p>å½“å¯¹åŒä¸€æ¡è®°å½•æ›´æ–°çš„æ¬¡æ•°å¤šäº†ï¼Œæ‰€æœ‰çš„è¿™äº›æ—¥å¿—ä¼šè¢«<code>roll_pointer</code>å±æ€§è¿æ¥æˆä¸€ä¸ªå•é“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨å°±æ˜¯ç‰ˆæœ¬é“¾ï¼Œè€Œç‰ˆæœ¬é“¾çš„å¤´èŠ‚ç‚¹å°±æ˜¯å½“å‰è®°å½•çš„æœ€æ–°å€¼ã€‚</p><p><img src="http://qiniu.chanmufeng.com/2022-04-19-085538.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220419165538395" loading="lazy"></p><blockquote><p>æ³¨ï¼šè¿™ç§æ—¥å¿—çš„æ ¼å¼å’Œæ™®é€šè®°å½•çš„æ ¼å¼å…¶å®å¹¶ä¸ç›¸åŒï¼Œä¸Šå›¾ä¸­æˆ‘ä»¬åªå…³æ³¨ä¸¤è€…ä¹‹é—´å…±åŒçš„éƒ¨åˆ†ã€‚</p></blockquote><p>ä¸Šå›¾å±•ç¤ºäº†ä¸€æ¡è®°å½•çš„ç‰ˆæœ¬é“¾ã€‚è¯¥æ¡è®°å½•çš„æœ€åˆå§‹ç‰ˆæœ¬æ˜¯ç”±idä¸º<code>21</code>çš„äº‹åŠ¡è¿›è¡Œ<code>UPDATE</code>å¾—åˆ°çš„ï¼ˆå¤§å®¶å¯ä»¥æƒ³ä¸€ä¸‹ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆä¸å¯èƒ½æ˜¯<code>INSERT</code>å‘¢ï¼Ÿï¼‰</p><p>åæ¥ï¼Œè¿™æ¡è®°å½•åˆ†åˆ«è¢«äº‹åŠ¡<code>280</code>å’Œäº‹åŠ¡<code>300</code>å„è‡ªè¿ç»­<code>UPDATE</code>äº†ä¸¤æ¬¡ã€‚è¿™é‡Œæœ‰ä¸ªç»†èŠ‚ï¼Œäº‹åŠ¡<code>280</code>å’Œäº‹åŠ¡<code>300</code>å¹¶æ²¡æœ‰äº¤å‰ç€æ›´æ–°è¿™æ¡è®°å½•ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¹Ÿç•™ç»™äº²çˆ±çš„ä½ æ€è€ƒå§ã€‚</p><p>InnoDBæ­£æ˜¯åˆ©ç”¨è¿™ä¸ªç‰ˆæœ¬é“¾æ¥æ§åˆ¶ä¸åŒäº‹åŠ¡è®¿é—®ç›¸åŒè®°å½•çš„è¡Œä¸ºï¼Œè¿™ç§æœºåˆ¶å°±æ˜¯MySQLå¤§åé¼é¼çš„<code>MVCC</code>ï¼ˆMulti-Version Concurrency Controlï¼‰ï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚</p><p>è€Œä¸Šæ–‡ä¸­æˆ‘ä»¬ä¸€ç›´æåŠçš„æ—¥å¿—ï¼Œå°±æ˜¯å¤§åé¼é¼çš„<code>undo</code>æ—¥å¿—ã€‚</p><blockquote><p>é™¤äº†æ ‡é¢˜ï¼Œåœ¨æ­£æ–‡ä¸­æˆ‘å°½é‡æ²¡æœ‰æåŠ<code>MVCC</code>æœ¯è¯­ï¼Œå¯æŠŠæˆ‘æ†‹åäº†ã€‚å› ä¸ºå¯¹äºæ²¡æœ‰äº†è§£è¿‡è¿™ä¸ªæ¦‚å¿µçš„è¯»è€…è€Œè¨€ï¼Œè¿™ä¸ªæœ¯è¯­ç¡®å®æœ‰ç‚¹è®©äººå®³æ€•ã€‚ä¸è¿‡çœ‹åˆ°è¿™å„¿çš„è¯ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—ä¹Ÿä¸è¿‡å¦‚æ­¤å‘¢ï¼Ÿ</p></blockquote><p><img src="http://qiniu.chanmufeng.com/2022-04-19-092513.png" alt="image-20220419172512354" loading="lazy"></p><p>æ¥ä¸‹æ¥å°±æ˜¯çœ‹ä¸€ä¸‹MySQLçš„å„ä¸ªéš”ç¦»çº§åˆ«æ˜¯æ€ä¹ˆåˆ©ç”¨<code>MVCC</code>çš„ã€‚</p><h3 id="_8-2-readview" tabindex="-1"><a class="header-anchor" href="#_8-2-readview" aria-hidden="true">#</a> 8.2. ReadView</h3><p><code>READ UNCOMMITTED</code>éš”ç¦»çº§åˆ«å•¥ä¹Ÿä¸æ˜¯ï¼Œè„è¯»ã€ä¸å¯é‡è¯»å’Œå¹»è¯»é—®é¢˜ä¸€ä¸ªéƒ½è§£å†³ä¸äº†ï¼Œæ‰€ä»¥å¹²è„†åœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«ä¸‹ç›´æ¥è¯»å–è®°å½•çš„æœ€æ–°ç‰ˆæœ¬å°±å¾—äº†ã€‚</p><p>è€Œ<code>SERIALIZALE</code>éš”ç¦»çº§åˆ«åˆçŸ«æ‰è¿‡æ­£ï¼Œå¿…é¡»å¾—ç”¨é”æœºåˆ¶æ‰èƒ½å®ç°ï¼Œæ‰€ä»¥å°±å…ˆæŒ‰ä¸‹ä¸è¡¨äº†ã€‚</p><p>å¯¹äºä½¿ç”¨<code>READ COMMITTED</code>å’Œ<code>REPEATABLE READ</code>éš”ç¦»çº§åˆ«çš„äº‹åŠ¡è€Œè¨€ï¼Œå†³ä¸å…è®¸å‘ç”Ÿè„è¯»ç°è±¡ï¼ˆå¿˜è®°äº†çš„è¯å†å›å»çœ‹çœ‹è¡¨æ ¼ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœäº‹åŠ¡<code>T2</code>å·²ç»ä¿®æ”¹äº†è®°å½•ä½†æ˜¯æ²¡æœ‰æäº¤ï¼Œé‚£<code>T1</code>å°±ä¸èƒ½ç›´æ¥è¯»å–<code>T2</code>ä¿®æ”¹ä¹‹åçš„å†…å®¹ã€‚</p><p>ç°åœ¨çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯ï¼Œæ€ä¹ˆåˆ¤æ–­ç‰ˆæœ¬é“¾ä¸­çš„å“ªä¸ªç‰ˆæœ¬æ˜¯å½“å‰äº‹åŠ¡å¯è§çš„ã€‚</p><p>ä¸ºæ­¤ï¼ŒInnoDBçš„è®¾è®¡è€…æå‡ºäº†<code>ReadView</code>çš„æ¦‚å¿µï¼Œå…¶ä¸­åŒ…å«äº†4ä¸ªæ¯”è¾ƒé‡è¦çš„å†…å®¹ï¼š</p><ul><li><code>m_ids</code>ï¼šç”Ÿæˆ<code>ReadView</code>æ—¶ï¼Œå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡idåˆ—è¡¨ï¼›</li><li><code>min_trx_id</code>ï¼šç”Ÿæˆ<code>ReadView</code>æ—¶ï¼Œå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡idï¼Œä¹Ÿå°±æ˜¯<code>m_ids</code>ä¸­çš„æœ€å°å€¼ï¼›</li><li><code>max_trx_id</code>ï¼šç”Ÿæˆ<code>ReadView</code>æ—¶ï¼Œå¾…åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„idå·ï¼›</li><li><code>creator_trx_id</code>ï¼šç”Ÿæˆå½“å‰<code>ReadView</code>çš„äº‹åŠ¡çš„äº‹åŠ¡idã€‚</li></ul><p><img src="http://qiniu.chanmufeng.com/2022-04-19-142014.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220419222014136" loading="lazy"></p><p>æœ‰äº†<code>ReadView</code>è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œäº‹åŠ¡åˆ¤æ–­å¯è§æ€§çš„è§„åˆ™å°±æ˜¯è¿™æ ·çš„ï¼š</p><ol start="0"><li>ä»ç‰ˆæœ¬é“¾ä¸­çš„æœ€æ–°ç‰ˆæœ¬å¼€å§‹åˆ¤æ–­</li><li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„<code>trx_id = creator_trx_id</code>ï¼Œè¯´æ˜è¿™ä¸ªç‰ˆæœ¬å°±æ˜¯å½“å‰äº‹åŠ¡ä¿®æ”¹çš„ï¼Œå…è®¸è®¿é—®ï¼›</li><li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„<code>trx_id &lt; min_trx_id</code>ï¼ˆæœªæäº¤äº‹åŠ¡çš„æœ€å°idï¼‰ï¼Œè¯´æ˜ç”Ÿæˆè¿™ä¸ªç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰<code>ReadView</code>ç”Ÿæˆä¹‹å‰å°±å·²ç»æäº¤äº†ï¼Œå…è®¸è®¿é—®ï¼›</li><li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„<code>trx_id &gt; max_trx_id</code>ï¼ˆå¾…åˆ†é…çš„äº‹åŠ¡idï¼‰ï¼Œè¯´æ˜ç”Ÿæˆè¿™ä¸ªç‰ˆæœ¬çš„äº‹åŠ¡æ˜¯åœ¨å½“å‰ReadViewç”Ÿæˆä¹‹åå»ºç«‹çš„ï¼Œä¸å…è®¸è®¿é—®ï¼›</li><li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„<code>trx_id</code>åœ¨<code>min_trx_id</code>å’Œ<code>max_trx_id</code>ä¹‹é—´ï¼Œé‚£å°±éœ€è¦åˆ¤æ–­<code>trx_id</code>æ˜¯å¦åœ¨<code>m_ids</code>ä¹‹ä¸­ï¼Œå¦‚æœåœ¨ï¼Œè¯´æ˜ç”Ÿæˆå½“å‰<code>ReadView</code>æ—¶ï¼Œç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œå› æ­¤ä¸å…è®¸è®¿é—®ã€‚å¦åˆ™ï¼Œå¯ä»¥è®¿é—®ï¼›</li><li>å¦‚æœå½“å‰ç‰ˆæœ¬ä¸å¯è§ï¼Œå°±æ²¿ç€ç‰ˆæœ¬é“¾æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼Œé‡å¤ä¸Šé¢çš„1ï½4æ­¥ã€‚</li></ol><p><code>READ COMMITTED</code>å’Œ<code>REPEATABLE READ</code>éš”ç¦»çº§åˆ«ä¹‹é—´çš„ä¸åŒä¹‹å¤„å°±æ˜¯ç”Ÿæˆ<code>ReadView</code>çš„æ—¶æœºä¸åŒã€‚æ¥ä¸‹æ¥å…·ä½“çœ‹ä¸€ä¸‹å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ã€‚</p><h4 id="_8-2-1-read-committed" tabindex="-1"><a class="header-anchor" href="#_8-2-1-read-committed" aria-hidden="true">#</a> 8.2.1. READ COMMITTED</h4><p><code>READ COMMITTED</code>æ˜¯æ¯æ¬¡è¯»å–æ•°æ®ä¹‹å‰éƒ½ç”Ÿæˆä¸€ä¸ª<code>ReadView</code>ã€‚</p><p>æˆ‘ä»¬æ¥åšä¸ªå®éªŒï¼Œå®éªŒä¹‹å‰å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬çš„ç›®æ ‡è®°å½•ç°åœ¨çš„å€¼ï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; SELECT * FROM user_innodb WHERE id = 1;
+----+-------------+--------+
| id | name        | gender |
+----+-------------+--------+
|  1 | wanggangdan |      1 |
+----+-------------+--------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡è®¾ç³»ç»Ÿä¸­æœ‰ä¸¤ä¸ªäº‹åŠ¡idåˆ†åˆ«ä¸º<code>100</code>ï¼Œ<code>200</code>çš„äº‹åŠ¡<code>T1</code>ã€<code>T2</code>åœ¨æ‰§è¡Œï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T1(100)å¼€å§‹æ‰§è¡Œ
mysql&gt; BEGIN;

mysql&gt; UPDATE user_innodb SET name = &#39;chanmufeng&#39; WHERE id = 1;
mysql&gt; UPDATE user_innodb SET name = &#39;zhaosi&#39; WHERE id = 1;

# æ³¨æ„ï¼Œäº‹åŠ¡T1(100)å¹¶æ²¡æœ‰æäº¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T2(200)å¼€å§‹æ‰§è¡Œ
mysql&gt; BEGIN;

# åšäº†å…¶ä»–è¡¨çš„ä¸€äº›å¢åˆ æ”¹æ“ä½œ

# æ³¨æ„ï¼Œäº‹åŠ¡T2(200)å¹¶æ²¡æœ‰æäº¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼Œè¡¨<code>user_innodb</code>ä¸­idä¸º1çš„è®°å½•çš„ç‰ˆæœ¬é“¾çš„å½¢å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="http://qiniu.chanmufeng.com/2022-04-20-074618.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220420154617575" loading="lazy"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨æ–°çš„ä¼šè¯ä¸­å°†éš”ç¦»çº§åˆ«è®¾ç½®ä¸º<code>READ COMMITTED</code>ï¼Œå¹¶å¼€å§‹äº‹åŠ¡<code>T3</code></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># åœ¨æ–°çš„ä¼šè¯ä¸­è®¾ç½®SESSIONçº§åˆ«çš„éš”ç¦»çº§åˆ«ï¼Œè¿™ç§è®¾ç½®æ–¹å¼å¯¹å½“å‰ä¼šè¯çš„åç»­æ‰€æœ‰äº‹åŠ¡ç”Ÿæ•ˆ
mysql&gt; SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;

# æŸ¥çœ‹å½“å‰ä¼šè¯é»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œå‘ç°æ˜¯READ-COMMITTEDï¼Œè¯´æ˜è®¾ç½®æˆåŠŸ
mysql&gt; SHOW VARIABLES LIKE &#39;transaction_isolation&#39;;
+-----------------------+----------------+
| Variable_name         | Value          |
+-----------------------+----------------+
| transaction_isolation | READ-COMMITTED |
+-----------------------+----------------+

# T3å¼€å¯äº‹åŠ¡
mysql&gt; BEGIN;

# T3æŸ¥è¯¢idä¸º1çš„è®°å½•ä¿¡æ¯ï¼Œå‘ç°æ˜¯æœ€åŸå§‹çš„ã€äº‹åŠ¡T1ä¿®æ”¹ä¹‹å‰çš„ç‰ˆæœ¬
mysql&gt; SELECT * FROM user_innodb WHERE id = 1;
+----+-------------+--------+
| id | name        | gender |
+----+-------------+--------+
|  1 | wanggangdan |      1 |
+----+-------------+--------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¯¹ç…§ç€ä¸Šæ–‡è¯´è¿‡çš„å¯è§æ€§åˆ¤æ–­è§„åˆ™ï¼Œæ¥æ‹ä¸€éæ•´ä¸ªæµç¨‹ï¼š</p><ol><li><code>T3</code>æ‰§è¡Œ<code>SELECT</code>æ—¶ä¼šé¦–å…ˆç”Ÿæˆä¸€ä¸ª<code>ReadView</code>æ•°æ®ç»“æ„ï¼Œè¿™ä¸ª<code>ReadView</code>çš„ä¿¡æ¯å¦‚ä¸‹ <ul><li><code>m_ids</code>åˆ—è¡¨çš„å†…å®¹æ˜¯<code>[100,200]</code></li><li><code>min_trx_id</code>ä¸º<code>100</code></li><li><code>max_trx_id</code>ä¸º<code>201</code>ï¼ˆè¿™é‡Œæˆ‘ä»¬å‡è®¾å¾…åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡å°±æ˜¯<code>201</code>ï¼‰</li><li><code>creator_trx_id</code>ä¸º<code>0</code>ï¼ˆå› ä¸ºäº‹åŠ¡<code>T3</code>åªæ˜¯<code>SELECT</code>è€Œå·²ï¼Œæ²¡æœ‰åšå¢åˆ æ”¹æ“ä½œï¼Œæ‰€ä»¥äº‹åŠ¡idä¸º<code>0</code>ï¼‰</li></ul></li><li>ä»ç‰ˆæœ¬é“¾ä¸­çš„æœ€æ–°ç‰ˆæœ¬å¼€å§‹åˆ¤æ–­ï¼›</li><li>æœ€æ–°ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>100</code>ï¼Œåœ¨<code>min_trx_id</code>å’Œ<code>max_trx_id</code>ä¹‹é—´ï¼Œç»§ç»­åˆ¤æ–­<code>trx_id</code>æ˜¯å¦åœ¨<code>m_ids</code>ä¹‹ä¸­ï¼Œå‘ç°åœ¨ï¼Œè¯´æ˜ç”Ÿæˆå½“å‰<code>ReadView</code>æ—¶ï¼Œç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œå› æ­¤ä¸å…è®¸è®¿é—®ï¼Œæ ¹æ®é“¾è¡¨æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</li><li>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>100</code>ï¼Œä¸å…è®¸è®¿é—®ï¼Œç†ç”±åŒä¸Šï¼Œç»§ç»­è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</li><li>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>99</code>ï¼Œå°äº<code>min_trx_id</code>å€¼<code>100</code>ï¼Œæ‰€ä»¥å½“å‰ç‰ˆæœ¬å¯¹<code>T3</code>å¯è§ï¼Œè¿”å›çš„æ•°æ®å°±æ˜¯<code>name</code>ä¸º&#39;wanggangdan&#39;çš„è¿™æ¡è®°å½•ã€‚</li></ol><p>æ¥ç€ï¼Œå®éªŒç»§ç»­ï¼Œæˆ‘ä»¬æŠŠ<code>T1</code>æäº¤ä¸€ä¸‹ï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T1æäº¤
mysql&gt; COMMIT;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶ååœ¨äº‹åŠ¡<code>T2</code>ä¸­ï¼ˆç›®å‰è¿˜æ²¡æœ‰æäº¤ï¼‰å†æ¬¡æ›´æ–°idä¸º1çš„è®°å½•</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T2ç»§ç»­æ‰§è¡Œidä¸º1çš„è®°å½•çš„æ›´æ–°æ“ä½œï¼Œä½†æ˜¯ä¾ç„¶ä¸æäº¤
mysql&gt; UPDATE user_innodb SET name = &#39;wangwu&#39; WHERE id = 1;
mysql&gt; UPDATE user_innodb SET name = &#39;wanger&#39; WHERE id = 1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œç‰ˆæœ¬é“¾å°±å˜æˆäº†è¿™ä¸ªæ ·å­ï¼š</p><p><img src="http://qiniu.chanmufeng.com/2022-04-20-090613.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220420170613608" loading="lazy"></p><p>æœ€ååœ¨äº‹åŠ¡<code>T3</code>ä¸­é‡æ–°æ‰§è¡ŒæŸ¥è¯¢ï¼Œå†æ¥çœ‹ä¸€ä¸‹ç»“æœé›†ä¼šæ˜¯ä»€ä¹ˆï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T3å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢
mysql&gt; SELECT * FROM user_innodb WHERE id = 1;
+----+--------+--------+
| id | name   | gender |
+----+--------+--------+
|  1 | zhaosi |      1 |
+----+--------+--------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æ¥æ‹ä¸€ä¸‹è¿™æ¬¡çš„æŸ¥è¯¢çš„æ‰§è¡Œè¿‡ç¨‹ï¼š</p><ol><li><p>å› ä¸º<code>T3</code>çš„éš”ç¦»çº§åˆ«æ˜¯<code>READ COMMITTED</code>ï¼Œæ‰€ä»¥å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ª<code>ReadView</code>ï¼Œæ­¤æ—¶è¿™ä¸ª<code>ReadView</code>é‡Œè¾¹çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p><ul><li><code>m_ids</code>åˆ—è¡¨çš„å†…å®¹æ˜¯<code>[200]</code>ï¼Œå› ä¸º<code>T1</code>å·²ç»æäº¤äº†</li><li><code>min_trx_id</code>ä¸º<code>200</code></li><li><code>max_trx_id</code>ä¸º<code>201</code>ï¼ˆè¿™é‡Œæˆ‘ä»¬å‡è®¾å¾…åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡å°±æ˜¯<code>201</code>ï¼‰</li><li><code>creator_trx_id</code>ä¸º<code>0</code>ï¼ˆå› ä¸ºäº‹åŠ¡<code>T3</code>åªæ˜¯<code>SELECT</code>è€Œå·²ï¼Œæ²¡æœ‰åšå¢åˆ æ”¹æ“ä½œï¼Œæ‰€ä»¥äº‹åŠ¡idä¸º<code>0</code>ï¼‰</li></ul></li><li><p>ä»ç‰ˆæœ¬é“¾ä¸­çš„æœ€æ–°ç‰ˆæœ¬å¼€å§‹åˆ¤æ–­ï¼›</p></li><li><p>æœ€æ–°ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>200</code>ï¼Œåœ¨<code>min_trx_id</code>å’Œ<code>max_trx_id</code>ä¹‹é—´ï¼Œç»§ç»­åˆ¤æ–­<code>trx_id</code>æ˜¯å¦åœ¨<code>m_ids</code>ä¹‹ä¸­ï¼Œå‘ç°åœ¨ï¼Œè¯´æ˜ç”Ÿæˆå½“å‰<code>ReadView</code>æ—¶ï¼Œç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œå› æ­¤ä¸å…è®¸è®¿é—®ï¼Œæ ¹æ®é“¾è¡¨æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</p></li><li><p>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>200</code>ï¼Œä¸å…è®¸è®¿é—®ï¼Œç†ç”±åŒä¸Šï¼Œç»§ç»­è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</p></li><li><p>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>100</code>ï¼Œå°äº<code>min_trx_id</code>å€¼<code>200</code>ï¼Œæ‰€ä»¥å½“å‰ç‰ˆæœ¬å¯¹<code>T3</code>å¯è§ï¼Œè¿”å›çš„æ•°æ®å°±æ˜¯<code>name</code>ä¸º&#39;zhaosi&#39;çš„è¿™æ¡è®°å½•ã€‚</p></li></ol><p>é‡ç‚¹å°±æ˜¯ï¼š<strong><code>READ COMMITTED</code>åœ¨æ¯æ¬¡SELECTçš„æ—¶å€™éƒ½é‡æ–°ç”Ÿæˆä¸€ä¸ªReadViewã€‚</strong></p><blockquote><p>æ³¨æ„ï¼Œåœ¨åšå®éªŒçš„æ—¶å€™å¦‚æœé•¿æ—¶é—´æœªæ“ä½œç»ˆç«¯ï¼Œå¯èƒ½å¯¼è‡´å’ŒMySQLæœåŠ¡å™¨çš„è¿æ¥è‡ªåŠ¨æ–­å¼€ï¼Œè¿æ¥ä¸€æ—¦æ–­å¼€ï¼Œäº‹åŠ¡ä¼šè‡ªåŠ¨è¿›è¡Œæäº¤ã€‚åšå®éªŒçš„å°ä¼™ä¼´éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</p></blockquote><h4 id="_8-2-2-repeatable-read" tabindex="-1"><a class="header-anchor" href="#_8-2-2-repeatable-read" aria-hidden="true">#</a> 8.2.2. REPEATABLE READ</h4><p>å­¦ä¼šäº†<code>READ COMMITTED</code>ï¼Œ<code>REPEATABLE READ</code>ä¹Ÿæ˜¯åŒæ ·çš„é“ç†äº†ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼š</p><p><strong><code>REPEATABLE READ</code>åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œ<code>SELECT</code>çš„æ—¶å€™ç”Ÿæˆä¸€ä¸ª<code>ReadView</code>ï¼Œä¹‹åä¸ç®¡<code>SELECT</code>å¤šå°‘æ¬¡ï¼Œéƒ½æ˜¯ç”¨æœ€å¼€å§‹ç”Ÿæˆçš„<code>ReadView</code>ä¸­çš„å˜é‡è¿›è¡Œåˆ¤æ–­ã€‚</strong></p><p>è¿˜æ˜¯æ‹¿ä¸Šé¢çš„äº‹åŠ¡idä¸º<code>100</code>å’Œ<code>200</code>çš„äº‹åŠ¡ä¸ºä¾‹ï¼Œåœ¨å®éªŒä¹‹å‰ï¼Œå…ˆå°†æ•°æ®é‡ç½®åˆ°æœ€åˆçš„çŠ¶æ€ã€‚</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; UPDATE user_innodb SET name = &#39;wanggangdan&#39; WHERE id = 1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>äº‹åŠ¡<code>T1</code>å…ˆæ‰§è¡Œï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T1(100)å¼€å§‹æ‰§è¡Œ
mysql&gt; BEGIN;

mysql&gt; UPDATE user_innodb SET name = &#39;chanmufeng&#39; WHERE id = 1;
mysql&gt; UPDATE user_innodb SET name = &#39;zhaosi&#39; WHERE id = 1;

# æ³¨æ„ï¼Œäº‹åŠ¡T1(100)å¹¶æ²¡æœ‰æäº¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T2(200)å¼€å§‹æ‰§è¡Œ
mysql&gt; BEGIN;

# åšäº†å…¶ä»–è¡¨çš„ä¸€äº›å¢åˆ æ”¹æ“ä½œ

# æ³¨æ„ï¼Œäº‹åŠ¡T2(200)å¹¶æ²¡æœ‰æäº¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼Œè¡¨<code>user_innodb</code>ä¸­idä¸º1çš„è®°å½•çš„ç‰ˆæœ¬é“¾çš„å½¢å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="http://qiniu.chanmufeng.com/2022-04-20-074618.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220420154617575" loading="lazy"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨æ–°çš„ä¼šè¯ä¸­å°†éš”ç¦»çº§åˆ«è®¾ç½®ä¸º<code>REPEATABLE READ</code>ï¼Œå¹¶å¼€å§‹äº‹åŠ¡<code>T3</code></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># åœ¨æ–°çš„ä¼šè¯ä¸­è®¾ç½®SESSIONçº§åˆ«çš„éš”ç¦»çº§åˆ«ï¼Œè¿™ç§è®¾ç½®æ–¹å¼å¯¹å½“å‰ä¼šè¯çš„åç»­æ‰€æœ‰äº‹åŠ¡ç”Ÿæ•ˆ
mysql&gt; SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;

# æŸ¥çœ‹å½“å‰ä¼šè¯é»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œå‘ç°æ˜¯READ-COMMITTEDï¼Œè¯´æ˜è®¾ç½®æˆåŠŸ
mysql&gt; SHOW VARIABLES LIKE &#39;transaction_isolation&#39;;
+-----------------------+-----------------+
| Variable_name         | Value           |
+-----------------------+-----------------+
| transaction_isolation | REPEATABLE-READ |
+-----------------------+-----------------+

# T3å¼€å¯äº‹åŠ¡
mysql&gt; BEGIN;

# T3æŸ¥è¯¢idä¸º1çš„è®°å½•ä¿¡æ¯ï¼Œå‘ç°æ˜¯æœ€åŸå§‹çš„ã€äº‹åŠ¡T1ä¿®æ”¹ä¹‹å‰çš„ç‰ˆæœ¬
mysql&gt; SELECT * FROM user_innodb WHERE id = 1;
+----+-------------+--------+
| id | name        | gender |
+----+-------------+--------+
|  1 | wanggangdan |      1 |
+----+-------------+--------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æ‹è¿™ä¸ªæµç¨‹ä½ åº”è¯¥å·²ç»ç†Ÿæ‚‰å¾ˆå¤šäº†ï¼š</p><ol><li><code>T3</code>åˆæ¬¡æ‰§è¡Œ<code>SELECT</code>æ—¶ä¼šç”Ÿæˆä¸€ä¸ª<code>ReadView</code>æ•°æ®ç»“æ„ï¼Œè¿™ä¸ª<code>ReadView</code>çš„ä¿¡æ¯å¦‚ä¸‹ <ul><li><code>m_ids</code>åˆ—è¡¨çš„å†…å®¹æ˜¯<code>[100,200]</code></li><li><code>min_trx_id</code>ä¸º<code>100</code></li><li><code>max_trx_id</code>ä¸º<code>201</code>ï¼ˆè¿™é‡Œæˆ‘ä»¬å‡è®¾å¾…åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡å°±æ˜¯<code>201</code>ï¼‰</li><li><code>creator_trx_id</code>ä¸º<code>0</code>ï¼ˆå› ä¸ºäº‹åŠ¡<code>T3</code>åªæ˜¯<code>SELECT</code>è€Œå·²ï¼Œæ²¡æœ‰åšå¢åˆ æ”¹æ“ä½œï¼Œæ‰€ä»¥äº‹åŠ¡idä¸º<code>0</code>ï¼‰</li></ul></li><li>ä»ç‰ˆæœ¬é“¾ä¸­çš„æœ€æ–°ç‰ˆæœ¬å¼€å§‹åˆ¤æ–­ï¼›</li><li>æœ€æ–°ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>100</code>ï¼Œåœ¨<code>min_trx_id</code>å’Œ<code>max_trx_id</code>ä¹‹é—´ï¼Œç»§ç»­åˆ¤æ–­<code>trx_id</code>æ˜¯å¦åœ¨<code>m_ids</code>ä¹‹ä¸­ï¼Œå‘ç°åœ¨ï¼Œè¯´æ˜ç”Ÿæˆå½“å‰<code>ReadView</code>æ—¶ï¼Œç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œå› æ­¤ä¸å…è®¸è®¿é—®ï¼Œæ ¹æ®é“¾è¡¨æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</li><li>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>100</code>ï¼Œä¸å…è®¸è®¿é—®ï¼Œç†ç”±åŒä¸Šï¼Œç»§ç»­è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</li><li>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>99</code>ï¼Œå°äº<code>min_trx_id</code>å€¼<code>100</code>ï¼Œæ‰€ä»¥å½“å‰ç‰ˆæœ¬å¯¹<code>T3</code>å¯è§ï¼Œè¿”å›çš„æ•°æ®å°±æ˜¯<code>name</code>ä¸º&#39;wanggangdan&#39;çš„è¿™æ¡è®°å½•ã€‚</li></ol><p>æ¥ç€ï¼Œå®éªŒç»§ç»­ï¼Œæˆ‘ä»¬æŠŠ<code>T1</code>æäº¤ä¸€ä¸‹ï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T1æäº¤
mysql&gt; COMMIT;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶ååœ¨äº‹åŠ¡<code>T2</code>ä¸­ï¼ˆç›®å‰è¿˜æ²¡æœ‰æäº¤ï¼‰å†æ¬¡æ›´æ–°idä¸º1çš„è®°å½•</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T2ç»§ç»­æ‰§è¡Œidä¸º1çš„è®°å½•çš„æ›´æ–°æ“ä½œï¼Œä½†æ˜¯ä¾ç„¶ä¸æäº¤
mysql&gt; UPDATE user_innodb SET name = &#39;wangwu&#39; WHERE id = 1;
mysql&gt; UPDATE user_innodb SET name = &#39;wanger&#39; WHERE id = 1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œç‰ˆæœ¬é“¾å°±å˜æˆäº†è¿™ä¸ªæ ·å­ï¼š</p><p><img src="http://qiniu.chanmufeng.com/2022-04-20-090613.png?imageView2/0/q/75|watermark/2/text/5YWs5LyX5Y-344CM6J2J5rKQ6aOO44CN/font/5b6u6L2v6ZuF6buR/fontsize/320/fill/IzAwMDAwMA==/dissolve/70/gravity/SouthEast/dx/10/dy/20" alt="image-20220420170613608" loading="lazy"></p><p>æœ€ååœ¨äº‹åŠ¡<code>T3</code>ä¸­é‡æ–°æ‰§è¡ŒæŸ¥è¯¢ï¼Œå†æ¥çœ‹ä¸€ä¸‹ç»“æœé›†ä¼šæ˜¯ä»€ä¹ˆï¼š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># äº‹åŠ¡T3å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢
mysql&gt; SELECT * FROM user_innodb WHERE id = 1;
+----+-------------+--------+
| id | name        | gender |
+----+-------------+--------+
|  1 | wanggangdan |      1 |
+----+-------------+--------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æ¥æ‹ä¸€ä¸‹è¿™æ¬¡çš„æŸ¥è¯¢çš„æ‰§è¡Œè¿‡ç¨‹ï¼š</p><ol><li><p>å› ä¸º<code>T3</code>çš„éš”ç¦»çº§åˆ«æ˜¯<code>REPEATABLE READ</code>ï¼Œæ‰€ä»¥è¿˜æ˜¯æ²¿ç”¨ä¸€å¼€å§‹ç”Ÿæˆçš„é‚£ä¸ª<code>ReadView</code>ï¼Œå†æŠ„ä¸€éï¼š</p><ul><li><code>m_ids</code>åˆ—è¡¨çš„å†…å®¹æ˜¯<code>[100,200]</code></li><li><code>min_trx_id</code>ä¸º<code>100</code></li><li><code>max_trx_id</code>ä¸º<code>201</code></li><li><code>creator_trx_id</code>ä¸º<code>0</code></li></ul></li><li><p>ä»ç‰ˆæœ¬é“¾ä¸­çš„æœ€æ–°ç‰ˆæœ¬å¼€å§‹åˆ¤æ–­ï¼›</p></li><li><p>æœ€æ–°ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>200</code>ï¼Œåœ¨<code>min_trx_id</code>å’Œ<code>max_trx_id</code>ä¹‹é—´ï¼Œç»§ç»­åˆ¤æ–­<code>trx_id</code>æ˜¯å¦åœ¨<code>m_ids</code>ä¹‹ä¸­ï¼Œå‘ç°åœ¨ï¼Œè¯´æ˜ç”Ÿæˆå½“å‰<code>ReadView</code>æ—¶ï¼Œç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œå› æ­¤ä¸å…è®¸è®¿é—®ï¼Œæ ¹æ®é“¾è¡¨æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</p></li><li><p>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>200</code>ï¼Œä¸å…è®¸è®¿é—®ï¼Œç†ç”±åŒä¸Šï¼Œç»§ç»­è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</p></li><li><p>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>100</code>ï¼Œåœ¨<code>min_trx_id</code>å’Œ<code>max_trx_id</code>ä¹‹é—´ï¼Œç»§ç»­åˆ¤æ–­<code>trx_id</code>æ˜¯å¦åœ¨<code>m_ids</code>ä¹‹ä¸­ï¼Œå‘ç°åœ¨ï¼Œè¯´æ˜ç”Ÿæˆå½“å‰<code>ReadView</code>æ—¶ï¼Œç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œå› æ­¤ä¸å…è®¸è®¿é—®ï¼Œæ ¹æ®é“¾è¡¨æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</p></li><li><p>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>100</code>ï¼Œä¸å…è®¸è®¿é—®ï¼Œç†ç”±åŒä¸Šï¼Œç»§ç»­è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼›</p></li><li><p>å½“å‰ç‰ˆæœ¬çš„<code>trx_id</code>æ˜¯<code>99</code>ï¼Œå°äº<code>min_trx_id</code>å€¼<code>100</code>ï¼Œæ‰€ä»¥å½“å‰ç‰ˆæœ¬å¯¹<code>T3</code>å¯è§ï¼Œè¿”å›çš„æ•°æ®å°±æ˜¯<code>name</code>ä¸º&#39;wanggangdan&#39;çš„è¿™æ¡è®°å½•ã€‚</p></li></ol><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>READ COMMITTED</code>éš”ç¦»çº§åˆ«ä¸‹ï¼Œ<code>T3</code>å‰åä¸¤æ¬¡<code>SELECT</code>å¾—åˆ°çš„ç»“æœå®Œå…¨ä¸€è‡´ï¼Œè·Ÿå…¶ä»–äº‹åŠ¡æäº¤ä¸æäº¤æ²¡æœ‰å…³ç³»ï¼Œå³ä½¿äº‹åŠ¡<code>T2</code>åæ¥ä¹Ÿæäº¤äº†ï¼Œä¹Ÿä¸å½±å“<code>T3</code>çš„æœç´¢ç»“æœã€‚æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯ä¸€è‡´æ€§çš„ç¨‹åº¦æ¯”<code>READ COMMITTED</code>æ›´å¼ºäº†å‘¢ï¼Ÿ</p><hr><p>å¥½äº†ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ä½ å·²ç»çŸ¥é“æ€ä¹ˆåˆ©ç”¨MVCCæ¥è§£å†³ä¸€è‡´æ€§è¯»é—®é¢˜äº†ï¼Œä½†æ˜¯å†™ä¸€è‡´æ€§è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿé‚£å°±æ˜¯ä¸‹ä¸€ç¯‡äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ä¸é”çš„å†…å®¹äº†ã€‚æ•¬è¯·å…³æ³¨å–½ã€‚</p></div><!----><footer class="page-meta"><!----><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/8/3 06:14:46</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: zhaoxaolong@163.com">chanmufeng</span><!--]--><!--]--></div></footer><nav class="page-nav"><!----><a href="/posts/storage/MySQL/MySQL%E9%94%81%E5%BC%80%E7%AF%87.html" class="nav-link next" aria-label="MySQLé”ï¼Œé”çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">MySQLé”ï¼Œé”çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ<span class="icon iconfont icon-creative"></span></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href='https://beian.miit.gov.cn/'>é²ICPå¤‡20023913å·</a></div><div class="copyright">Copyright Â© 2023 è‰æ²é£</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.ec803d45.js" defer></script>
  </body>
</html>
