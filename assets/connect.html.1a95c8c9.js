import{_ as o}from"./plugin-vue_export-helper.21dcd24c.js";import{o as t,c,a as s,b as p,e as a,d as n,r as i}from"./app.df556a34.js";const d={},l=a(`<p>\u5BA2\u6237\u7AEF\u5C31\u662F\u7528<code>connect()</code>\u51FD\u6570\u6765\u5EFA\u7ACB\u4E0E\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u8FDE\u63A5\u7684\u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">sockaddr</span> <span class="token operator">*</span>serv_addr<span class="token punctuation">,</span> <span class="token keyword">int</span> addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>sockfd</code>\u662F\u6211\u4EEC\u7684\u8001\u670B\u53CB\u4E86\uFF0C\u662F\u7531<code>socket()</code>\u51FD\u6570\u8FD4\u56DE\u7684\u5957\u63A5\u5B57\u63CF\u8FF0\u7B26\uFF0C<code>serv_addr</code>\u662F\u4E00\u4E2A\u6267\u884C\u5957\u63A5\u5B57\u5730\u5740\u7ED3\u6784 <code>struct sockaddr</code> \u7684\u6307\u9488\uFF0C <code>struct sockaddr</code> \u4E2D\u5B58\u50A8\u4E86\u76EE\u6807IP\u5730\u5740\u548C\u7AEF\u53E3\u53F7\u4FE1\u606F\uFF0C<code>addrlen</code>\u662F<code>serv_addr</code>\u6307\u5411\u7684<code>struct sockaddr</code> \u5927\u5C0F\u3002</p><p>\u518D\u6B21\u5F3A\u8C03\u4E00\u4E0B <code>getaddrinfo()</code> \u7684\u5999\u5904\uFF0C\u6240\u6709\u4F60\u9700\u8981\u7684\u8FDE\u63A5\u4FE1\u606F\u90FD\u53EF\u4EE5\u4ECE\u8FD9\u4E2A\u51FD\u6570\u7684\u8FD4\u56DE\u7ED3\u679C\u4E2D\u83B7\u53D6\u3002</p><p>\u5BA2\u6237\u7AEF\u5728\u8C03\u7528<code>connect()</code>\u4E4B\u524D\u4E0D\u5FC5\u975E\u5F97\u8C03\u7528<code>bind()</code>\u51FD\u6570\uFF0C\u56E0\u4E3A\u5982\u679C\u6709\u5FC5\u8981\uFF0C\u5185\u6838\u4F1A\u786E\u5B9A\u6E90IP\u5730\u5740\uFF0C\u5E76\u9009\u62E9\u4E00\u4E2A\u4E34\u65F6\u7AEF\u53E3\u53F7\u4F5C\u4E3A\u6E90\u7AEF\u53E3\u3002</p>`,5),r=n("\u4E3E\u4E00\u4E2A\u4F7F\u7528"),u=s("code",null,"connect()",-1),k=n('\u8FDE\u63A5\u5230"'),m={href:"http://www.chanmufeng.com",target:"_blank",rel:"noopener noreferrer"},v=n("www.chanmufeng.com"),_=n('" \u7684'),h=s("code",null,"3490",-1),b=n("\u7AEF\u53E3\u7684\u4F8B\u5B50\uFF1A"),f=a(`<div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">addrinfo</span> hints<span class="token punctuation">,</span> <span class="token operator">*</span>res<span class="token punctuation">;</span>
<span class="token keyword">int</span> sockfd<span class="token punctuation">;</span>

<span class="token comment">// first, load up address structs with getaddrinfo():</span>

<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hints<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> hints<span class="token punctuation">)</span><span class="token punctuation">;</span>
hints<span class="token punctuation">.</span>ai_family <span class="token operator">=</span> AF_UNSPEC<span class="token punctuation">;</span>
hints<span class="token punctuation">.</span>ai_socktype <span class="token operator">=</span> SOCK_STREAM<span class="token punctuation">;</span>

<span class="token function">getaddrinfo</span><span class="token punctuation">(</span><span class="token string">&quot;www.example.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3490&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hints<span class="token punctuation">,</span> <span class="token operator">&amp;</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// make a socket:</span>

sockfd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>res<span class="token operator">-&gt;</span>ai_family<span class="token punctuation">,</span> res<span class="token operator">-&gt;</span>ai_socktype<span class="token punctuation">,</span> res<span class="token operator">-&gt;</span>ai_protocol<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// connect!</span>

<span class="token function">connect</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">,</span> res<span class="token operator">-&gt;</span>ai_addr<span class="token punctuation">,</span> res<span class="token operator">-&gt;</span>ai_addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u548C\u4E0A\u4E00\u8282\u8BB2\u7684<code>bind()</code>\u4E00\u6837\uFF0C\u6709\u4E9B\u8001\u4EE3\u7801\u5728\u8C03\u7528<code>connect()</code>\u4E4B\u524D\u4F1A\u624B\u52A8\u5C01\u88C5 <code>struct sockaddr_in</code>\uFF0C\u7136\u540E\u4F20\u7ED9<code>connect()</code>\u4F5C\u4E3A\u53C2\u6570\u3002\u4F60\u73B0\u5728\u4ECD\u7136\u53EF\u4EE5\u8FD9\u4E48\u505A\uFF0C\u4F46\u662F\u6CA1\u5FC5\u8981\uFF01</p><p>\u5982\u679C\u4F60\u4F7F\u7528\u7684\u662FTCP\u5957\u63A5\u5B57\uFF0C\u8C03\u7528<code>connect</code>\u51FD\u6570\u4F1A\u89E6\u53D1TCP\u7684\u4E09\u6B21\u63E1\u624B\u8FC7\u7A0B\uFF0C\u800C\u4E14\u4EC5\u5728\u8FDE\u63A5\u6210\u529F\u6216\u8005\u5931\u8D25\u65F6\u624D\u4F1A\u8FD4\u56DE\uFF0C\u5931\u8D25\u8FD4\u56DE<code>-1</code>\uFF0C\u5E76\u4E14\u4F1A\u8BBE\u7F6E\u5168\u5C40\u53D8\u91CF<code>errno</code>\u7684\u503C\u3002</p>`,3);function g(w,y){const e=i("ExternalLinkIcon");return t(),c("div",null,[l,s("p",null,[r,u,k,s("a",m,[v,p(e)]),_,h,b]),f])}var E=o(d,[["render",g],["__file","connect.html.vue"]]);export{E as default};
